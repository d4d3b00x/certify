<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>AZ-104 ‚Äî Dominio 2 ¬∑ Implementar y administrar almacenamiento</title>
  <style>
    :root{
      --bg:#0b1020;--card:#111a3a;--border:#2a3b82;--text:#e8edff;--muted:#a7b4ff;
      --accent:#7ac7ff;--pink:#ff6ac1;--green:#6af7c0;--yellow:#ffd15c;--red:#ff9b9b;
      --blue:#74a8ff;--purple:#c59cff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:radial-gradient(1200px 600px at 10% -10%,#141a3c 0,#0b1020 50%,#070b18 100%);
      color:var(--text);
      font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      line-height:1.65;
    }
    a{color:var(--accent)}
    .wrap{max-width:1000px;margin:0 auto;padding:28px}
    .badge{
      display:inline-flex;align-items:center;gap:10px;
      border:1px solid var(--border);
      background:linear-gradient(180deg,#0f1844,#0d1438);
      padding:8px 14px;
      border-radius:999px;
      font-weight:900;
      color:#cbd6ff;
      box-shadow:0 0 0 3px #00000044;
    }
    h1{margin:10px 0 10px;font-size:1.9rem}
    h2{margin:22px 0 10px;font-size:1.25rem}
    .muted{color:var(--muted)}
    .card{
      background:linear-gradient(180deg,#101a48,#0d1538);
      border:1px solid var(--border);
      border-radius:14px;
      padding:16px;
      margin:12px 0;
      box-shadow:0 6px 32px #00000055;
    }
    ul{padding-left:18px;margin:6px 0}
    li+li{margin-top:6px}
    .ok{color:var(--green)}
    .warn{color:var(--yellow)}
    .bad{color:var(--red)}
    code,.mono{
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
    }
    .toc{
      background:linear-gradient(180deg,#0f1a4a,#0b1230);
      border:1px solid var(--border);
      border-radius:12px;
      padding:12px;
      margin:12px 0;
      display:grid;
      gap:6px;
    }
    .toc a{color:#e3ecff;text-decoration:none}
    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:12px;
    }
    .kicker{
      font-size:.85rem;
      letter-spacing:.06em;
      color:#cfd6ff;
      text-transform:uppercase;
    }
    .pill{
      display:inline-block;
      font-size:.75rem;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#0e1740;
      margin-right:6px;
    }
    .hl{
      background:linear-gradient(90deg,#1c245c,#191f4a);
      border-left:3px solid var(--accent);
      padding:10px;
      border-radius:10px;
    }
    .note{
      background:linear-gradient(180deg,#102f38,#0b2025);
      border:1px solid #2a5f6a;
    }
    .tip{
      background:linear-gradient(180deg,#163310,#10230b);
      border:1px solid #2a6a2a;
    }
    .warnbox{
      background:linear-gradient(180deg,#3a1b1b,#2a1010);
      border:1px solid #7a2a2a;
    }
    kbd{
      border:1px solid #3a4a88;
      border-bottom-width:3px;
      border-radius:6px;
      padding:1px 6px;
      background:#0e1640;
    }
    pre{
      background:#0a122e;
      border:1px solid #26336e;
      border-radius:12px;
      padding:12px;
      overflow:auto;
    }
    .footer{
      color:#aab7ff;
      font-size:.9rem;
      margin-top:22px;
    }
    .small{font-size:.9rem}
    strong{font-weight:600}
  </style>
</head>
<body>
<div class="wrap">
  <span class="badge">Azure ¬∑ Almacenamiento</span>
  <h1>AZ-104 ‚Äî Dominio 2 ¬∑ Implementar y administrar almacenamiento</h1>
  <p class="muted">
    Aqu√≠ est√° ‚Äúd√≥nde vive‚Äù tu dato: Blobs, Files, redundancia, rendimiento y seguridad.
    Si entiendes bien <strong>tipos de cuenta</strong>, <strong>niveles de acceso</strong>, 
    <strong>redundancia</strong> y <strong>acceso seguro</strong>, las preguntas de este dominio
    se vuelven muy previsibles.
  </p>

  <div class="toc">
    <div class="kicker">√çndice r√°pido para estudiar</div>
    <div class="grid">
      <a href="#conceptos">Conceptos clave que s√≠ caen</a>
      <a href="#decision">Gu√≠a de decisi√≥n pr√°ctica</a>
      <a href="#comandos">Comandos y rutas de portal</a>
      <a href="#escenarios">Escenarios tipo examen</a>
      <a href="#errores">Errores que te pueden costar puntos</a>
      <a href="#cross">C√≥mo se cruza con otros dominios</a>
    </div>
  </div>

  <div class="card" id="conceptos">
    <h2>Conceptos clave (los que quieres tener muy claros)</h2>
    <ul>
      <li>
        <strong>Tipos de cuenta de almacenamiento</strong><br>
        <span class="small">
          Para AZ-104, qu√©date con:
          <ul>
            <li><strong>StorageV2 (general purpose v2)</strong>: la opci√≥n por defecto. Soporta blobs, files, queues y tables.</li>
            <li><strong>Premium</strong>: pensado para <em>baja latencia y alto IOPS</em> (por ejemplo, discos de VM o cargas muy intensivas).</li>
            <li><strong>ADLS Gen2</strong> (hierarchical namespace activado): optimizado para anal√≠tica y big data, con ACLs tipo POSIX.</li>
          </ul>
          Si la pregunta no indica algo muy raro, casi siempre ser√° una cuenta <strong>StorageV2</strong>.
        </span>
      </li>
      <li>
        <strong>Servicios principales</strong><br>
        <span class="small">
          <ul>
            <li><strong>Blob Storage</strong>: objetos, backups, contenido web, datos de app.</li>
            <li><strong>Azure Files</strong>: compartidos de ficheros SMB/NFS, lift &amp; shift de servidores de ficheros.</li>
            <li><strong>Queues</strong>: mensajer√≠a sencilla entre componentes.</li>
            <li><strong>Tables</strong>: almacenamiento NoSQL sencillo (cada vez menos protagonista en el examen).</li>
          </ul>
          En las preguntas, si hablan de <em>‚Äúcompartir ficheros como si fuera un NAS‚Äù</em> ‚Üí piensa en <strong>Azure Files</strong>.
          Si hablan de objetos tipo ‚Äúfotos, logs, backups‚Äù ‚Üí <strong>Blob Storage</strong>.
        </span>
      </li>
      <li>
        <strong>Redundancia (LRS, ZRS, GRS, RA-GRS)</strong><br>
        <span class="small">
          Es de lo m√°s preguntado:
          <ul>
            <li><strong>LRS</strong>: 3 copias en el mismo datacenter.</li>
            <li><strong>ZRS</strong>: copias en varias zonas de la misma regi√≥n (resiliencia zonal).</li>
            <li><strong>GRS / RA-GRS</strong>: replicaci√≥n a otra regi√≥n emparejada (y con RA puedes leer en la secundaria).</li>
          </ul>
          Ideas clave de examen:
          <ul>
            <li>Si hablan de <strong>resistencia a la ca√≠da de una zona</strong> ‚Üí ZRS.</li>
            <li>Si hablan de <strong>DR regional</strong> (ca√≠da de la regi√≥n entera) ‚Üí GRS / RA-GRS.</li>
            <li><strong>Backup</strong> no es lo mismo que redundancia: son objetivos distintos.</li>
          </ul>
        </span>
      </li>
      <li>
        <strong>Niveles de acceso: Hot / Cool / Archive</strong><br>
        <span class="small">
          <ul>
            <li><strong>Hot</strong>: acceso frecuente, coste de almacenamiento m√°s alto, acceso barato.</li>
            <li><strong>Cool</strong>: acceso poco frecuente (al menos 30 d√≠as), m√°s barato almacenar.</li>
            <li><strong>Archive</strong>: datos a muy largo plazo, recuperaci√≥n lenta y m√°s cara, m√≠nimo 180 d√≠as.</li>
          </ul>
          El truco en el examen: ‚Äúdatos que casi nunca se leen, pero hay que guardarlos por temas legales‚Äù ‚Üí <strong>Cool/Archive</strong>
          + <strong>reglas de ciclo de vida</strong>.
        </span>
      </li>
      <li>
        <strong>Seguridad de acceso: claves, SAS y Azure AD</strong><br>
        <span class="small">
          Tres grandes formas de acceso:
          <ul>
            <li><strong>Account keys</strong>: acceso total al almacenamiento; usarlas directamente en apps es mala pr√°ctica.</li>
            <li><strong>SAS (Shared Access Signature)</strong>: acceso delegado y temporal sobre un recurso concreto, con permisos limitados.</li>
            <li><strong>Azure AD / RBAC</strong>: acceso basado en identidades (usuarios, grupos, managed identities).</li>
          </ul>
          Si el enunciado habla de <strong>dar acceso temporal a un tercero</strong> ‚Üí casi siempre es un <strong>SAS con caducidad corta</strong>.
        </span>
      </li>
      <li>
        <strong>Protecci√≥n de red: firewalls, endpoints y Private Link</strong><br>
        <span class="small">
          <ul>
            <li><strong>Firewall de Storage</strong>: restringe redes origen y permite solo VNets / IPs concretas.</li>
            <li><strong>Service endpoints</strong>: el tr√°fico a Storage va por la red de Azure, pero el DNS sigue apuntando a la IP p√∫blica del servicio.</li>
            <li><strong>Private Endpoints</strong>: IP privada dentro de tu VNet para el servicio PaaS.</li>
          </ul>
          Para el examen, cuando digan ‚Äúning√∫n tr√°fico desde Internet‚Äù / ‚Äúsolo desde la VNet corporativa‚Äù ‚Üí la soluci√≥n ‚Äúde libro‚Äù es
          <strong>Private Endpoint + DNS privado</strong>.
        </span>
      </li>
      <li>
        <strong>Protecci√≥n frente a borrados: versioning y soft delete</strong><br>
        <span class="small">
          Dos cosas t√≠picas:
          <ul>
            <li><strong>Blob versioning</strong>: cada cambio crea una versi√≥n; puedes volver atr√°s.</li>
            <li><strong>Soft delete</strong>: aunque se borre algo, se mantiene durante X d√≠as y puedes recuperarlo.</li>
          </ul>
          Pregunta cl√°sica: ‚Äúun usuario ha borrado por error datos cr√≠ticos‚Äù ‚Üí si ten√≠as <strong>soft delete o versioning</strong>,
          puedes restaurar sin tirar de backup.
        </span>
      </li>
      <li>
        <strong>Azure Files y Azure File Sync</strong><br>
        <span class="small">
          <ul>
            <li><strong>Azure Files</strong>: compartidos SMB/NFS; puedes unirlos a Entra ID o AD DS para control de acceso por identidad.</li>
            <li><strong>Azure File Sync</strong>: sincroniza un servidor de ficheros on-prem con Azure Files, con cache local y tiering.</li>
          </ul>
          Si la empresa quiere <em>‚Äúmantener el servidor de ficheros pero dejar de preocuparse por la cabina‚Äù</em> ‚Üí piensa en
          <strong>Azure File Sync</strong>.
        </span>
      </li>
    </ul>

    <div class="hl note" style="margin-top:10px">
      <span class="pill">üìò Tip del examen</span>
      Si la pregunta habla de <strong>costes a largo plazo</strong> y datos poco accedidos, suele combinar:
      <strong>niveles de acceso + reglas de ciclo de vida + redundancia adecuada</strong>.
    </div>
  </div>

  <div class="card" id="decision">
    <h2>Gu√≠a de decisi√≥n r√°pida (para el d√≠a del examen)</h2>
    <p class="small">
      Usa esto como ‚Äúchuleta mental‚Äù cuando leas los escenarios.
    </p>
    <ul>
      <li>
        <strong>‚ÄúNecesitamos compartir ficheros con usuarios de Windows‚Äù</strong><br>
        <span class="small">
          ‚Üí <strong>Azure Files + integraci√≥n con AD / Entra ID</strong>.  
          Si adem√°s quieren mantener ficheros on-prem con cach√© local ‚Üí a√±ade <strong>Azure File Sync</strong>.
        </span>
      </li>
      <li>
        <strong>‚ÄúGrandes vol√∫menes de datos para anal√≠tica / big data‚Äù</strong><br>
        <span class="small">
          ‚Üí <strong>ADLS Gen2</strong> (hierarchical namespace, ACLs POSIX, rendimiento para analytics).
        </span>
      </li>
      <li>
        <strong>‚ÄúQueremos DR regional para el almacenamiento‚Äù</strong><br>
        <span class="small">
          ‚Üí <strong>GRS / RA-GRS</strong> o <strong>GZRS / RA-GZRS</strong> seg√∫n el caso.  
          Recuerda: redundancia ‚â† backup, pero ayuda a mejorar RPO/RTO de la capa de datos.
        </span>
      </li>
      <li>
        <strong>‚ÄúAcceso estrictamente privado desde VNets‚Äù</strong><br>
        <span class="small">
          ‚Üí <strong>Private Endpoints + DNS privado</strong> y deshabilitar acceso desde Internet p√∫blico.
        </span>
      </li>
      <li>
        <strong>‚ÄúOptimizar costes de datos fr√≠os‚Äù</strong><br>
        <span class="small">
          ‚Üí <strong>Reglas de ciclo de vida</strong> que muevan blobs de Hot ‚Üí Cool ‚Üí Archive y borren versiones antiguas
          despu√©s de X d√≠as.
        </span>
      </li>
      <li>
        <strong>‚ÄúAcceso temporal a un contenedor para terceros‚Äù</strong><br>
        <span class="small">
          ‚Üí <strong>SAS</strong> (con expiraci√≥n corta, permisos m√≠nimos y si es posible basado en stored access policy).
        </span>
      </li>
    </ul>

    <div class="hl tip" style="margin-top:10px">
      <span class="pill">üéØ Estrategia</span>
      Identifica siempre estas palabras clave: <em>archivar, DR, compartir ficheros, acceso temporal, solo desde la VNet</em>.  
      Cada una suele empujar a una combinaci√≥n muy concreta de servicios.
    </div>
  </div>

  <div class="card" id="comandos">
    <h2>Comandos y rutas de portal que merece la pena practicar</h2>
    <p class="small">
      No hace falta saberse todo de memoria, pero s√≠ reconocer qu√© hace cada cosa.
    </p>
    <div class="grid">
      <div class="card" style="background:#0c1332">
        <div class="kicker">Crear cuenta StorageV2</div>
        <pre><code>az storage account create \
  -n &lt;storageName&gt; \
  -g &lt;resourceGroup&gt; \
  --sku Standard_LRS \
  --kind StorageV2 \
  --https-only true</code></pre>
        <p class="small">
          Portal: <strong>Storage accounts &gt; Create</strong>.  
          F√≠jate en: tipo de cuenta, redundancia y red desde el principio.
        </p>
      </div>

      <div class="card" style="background:#0c1332">
        <div class="kicker">Crear contenedor Blob</div>
        <pre><code>az storage container create \
  --account-name &lt;storageName&gt; \
  --name logs \
  --auth-mode login \
  --public-access off</code></pre>
        <p class="small">
          Portal: <strong>Storage account &gt; Containers &gt; + Container</strong>.
        </p>
      </div>

      <div class="card" style="background:#0c1332">
        <div class="kicker">Generar SAS</div>
        <pre><code>az storage blob generate-sas \
  --account-name &lt;storageName&gt; \
  --container-name logs \
  --name export.json \
  --permissions r \
  --expiry 2026-01-01T00:00Z \
  --https-only</code></pre>
        <p class="small">
          Practica leyendo bien los permisos y la caducidad.  
          Portal: pesta√±a <strong>Shared access signature</strong> o directamente sobre el recurso.
        </p>
      </div>

      <div class="card" style="background:#0c1332">
        <div class="kicker">Habilitar soft delete</div>
        <pre><code>az storage account blob-service-properties update \
  --account-name &lt;storageName&gt; \
  --enable-delete-retention true \
  --delete-retention-days 14</code></pre>
        <p class="small">
          Portal: <strong>Data protection</strong> dentro de la cuenta de almacenamiento.
        </p>
      </div>

      <div class="card" style="background:#0c1332">
        <div class="kicker">Regla simple de ciclo de vida</div>
        <pre><code>az storage account management-policy create \
  --account-name &lt;storageName&gt; \
  --policy "@policy.json"</code></pre>
        <p class="small">
          En el portal lo puedes hacer visualmente en <strong>Lifecycle management</strong>.
          Saber que existe ya te gana puntos.
        </p>
      </div>
    </div>
    <p class="muted small">
      Si puedes, monta una cuenta de pruebas y juega con contenedores, SAS, versioning y ciclo de vida.
      Te ayuda much√≠simo a fijar los conceptos.
    </p>
  </div>

  <div class="card" id="escenarios">
    <h2>Escenarios tipo examen (muy parecidos a los reales)</h2>
    <ul>
      <li>
        <strong>Escenario 1: Recuperar datos borrados por error</strong><br>
        <span class="small">
          Un usuario ha borrado un contenedor cr√≠tico con logs y no hay backup.  
          Soluci√≥n t√≠pica: tener <strong>soft delete y/o versioning</strong> habilitado y restaurar desde ah√≠.
          Si la pregunta es de dise√±o, la respuesta ser√° ‚Äúhabilitar estas opciones de protecci√≥n‚Äù.
        </span>
      </li>
      <li>
        <strong>Escenario 2: Datos fr√≠os para cumplimiento legal</strong><br>
        <span class="small">
          Se deben guardar documentos 7 a√±os, casi nunca se consultan, pero deben estar disponibles.  
          Combina:
          <ul>
            <li>Nivel <strong>Cool/Archive</strong> para los blobs.</li>
            <li><strong>Lifecycle management</strong> para moverlos autom√°ticamente seg√∫n antig√ºedad.</li>
            <li>Quiz√° <strong>GRS</strong> si piden requisitos de resiliencia extra.</li>
          </ul>
        </span>
      </li>
      <li>
        <strong>Escenario 3: NAS on-prem saturado</strong><br>
        <span class="small">
          El almacenamiento local est√° creciendo mucho y quieren moverlo a Azure, pero manteniendo los mismos shares
          para usuarios.  
          Respuesta t√≠pica: <strong>Azure Files + Azure File Sync</strong> con tiering para datos poco usados.
        </span>
      </li>
      <li>
        <strong>Escenario 4: Bloquear acceso desde Internet</strong><br>
        <span class="small">
          Una organizaci√≥n quiere que su cuenta de almacenamiento solo sea accesible desde una VNet concreta,
          nunca desde Internet.  
          Lo de libro: <strong>Private Endpoints</strong>, deshabilitar acceso p√∫blico y ajustar DNS privado.
        </span>
      </li>
      <li>
        <strong>Escenario 5: Compartir datos con proveedor externo</strong><br>
        <span class="small">
          Un proveedor necesita acceso temporal a un conjunto de blobs para descargar informes.  
          Respuesta: <strong>SAS con expiraci√≥n corta y permisos m√≠nimos</strong>,
          idealmente basado en una stored access policy para poder revocarla.
        </span>
      </li>
    </ul>

    <div class="hl tip" style="margin-top:10px">
      <span class="pill">üß™ C√≥mo practicar</span>
      Crea un caso inventado y responde:  
      ‚Äú¬øD√≥nde guardo los datos? ¬øQu√© redundancia? ¬øQu√© nivel? ¬øC√≥mo limito el acceso? ¬øQu√© pasa si alguien borra algo?‚Äù
      Si puedes razonarlo, est√°s listo para este dominio.
    </div>
  </div>

  <div class="card warnbox" id="errores">
    <h2>Errores comunes (que el examen ‚Äúcastiga‚Äù mucho)</h2>
    <ul>
      <li>
        <strong>Dejar contenedores con acceso p√∫blico sin pensarlo</strong><br>
        <span class="small">
          En el mundo real pasa; en el examen casi siempre es mala pr√°ctica salvo que el escenario hable expl√≠citamente
          de contenido p√∫blico.
        </span>
      </li>
      <li>
        <strong>Usar account keys en lugar de identidades o SAS</strong><br>
        <span class="small">
          Es mucho mejor: <strong>Managed Identity + RBAC</strong> o SAS.  
          Si ves opciones que filtran las keys al c√≥digo, suele ser la incorrecta.
        </span>
      </li>
      <li>
        <strong>No habilitar soft delete / versioning</strong><br>
        <span class="small">
          En un dise√±o ‚Äúde libro‚Äù casi siempre tendr√°s alguna forma de protecci√≥n ante borrados accidentales.
        </span>
      </li>
      <li>
        <strong>Elegir redundancia cara sin motivo</strong><br>
        <span class="small">
          No todo necesita GRS. F√≠jate si el escenario habla realmente de ca√≠da de regi√≥n o solo de un datacenter.
        </span>
      </li>
      <li>
        <strong>No pensar en DNS con Private Endpoints</strong><br>
        <span class="small">
          Private Endpoint sin ajustar DNS = app intentando ir por Internet.  
          Si la pregunta menciona que ‚Äúno se resuelve el nombre correctamente‚Äù, suele ir por aqu√≠.
        </span>
      </li>
    </ul>
  </div>

  <div class="card" id="cross">
    <h2>Cross-links con otros dominios</h2>
    <p class="small">
      Almacenamiento se mezcla con casi todo: identidades, redes, monitorizaci√≥n y seguridad.
    </p>
    <ul>
      <li>
        <strong>Con identidades y gobierno</strong><br>
        <span class="small">
          RBAC sobre cuentas de almacenamiento, uso de <strong>managed identities</strong> para acceder a blobs,
          y <strong>Azure Policy</strong> para forzar encriptado, tipos de redundancia o evitar cuentas p√∫blicas.
        </span>
      </li>
      <li>
        <strong>Con redes</strong><br>
        <span class="small">
          Private Endpoints en arquitecturas hub-and-spoke, firewalls y peering.  
          Muchas respuestas correctas combinan ‚ÄúStorage + Private Link + NSG/UDR‚Äù.
        </span>
      </li>
      <li>
        <strong>Con monitorizaci√≥n</strong><br>
          <span class="small">
            M√©tricas de capacidad, transacciones, errores y latencia.  
            Logs de acceso a Storage enviados a Log Analytics para auditor√≠a y detecci√≥n de anomal√≠as.
          </span>
      </li>
      <li>
        <strong>Con c√≥mputo</strong><br>
        <span class="small">
          VMs que montan Azure Files, apps que leen blobs, snapshots de discos que se almacenan en cuentas de almacenamiento.
        </span>
      </li>
    </ul>

    <p class="muted small">
      Intenta siempre pensar el ‚Äúcircuito completo‚Äù: identidad ‚Üí red ‚Üí Storage ‚Üí logs.
      Eso te ayuda a construir respuestas redondas que el examen premia.
    </p>
  </div>

  <div class="footer">
    <span class="pill">üß† Consejo final</span>
    Hazte un esquema simple: <strong>tipo de cuenta ‚Üí redundancia ‚Üí nivel de acceso ‚Üí forma de acceso ‚Üí protecci√≥n</strong>.  
    Con ese mapa en la cabeza, este dominio deja de dar miedo.
  </div>

</div>
</body>
</html>
