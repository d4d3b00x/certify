<!doctype html>
<html lang="es">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DYZ3GCXHEK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-DYZ3GCXHEK');
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0f1320" />

  <title>AZ-104: Simulador y Gu√≠a de Estudio ‚Äî Microsoft Azure Administrator | ITHub</title>
  <link rel="canonical" href="https://beta.ithub.es/certification/microsoft-azure/az-104/lz-azure-az-104.html" />
  <meta name="description" content="Simulador AZ-104 con preguntas por dominios (D1-D5), m√©tricas y gu√≠a de estudio en tarjetas. Practica Microsoft Azure Administrator y supera 700/1000." />
  <meta name="keywords" content="AZ-104, simulador AZ-104, preguntas AZ-104 en espa√±ol, Microsoft Azure Administrator, gu√≠a de estudio AZ-104, dominios D1 D2 D3 D4 D5" />

  <style>
    :root{
      --bg:#0f1320;--surface:#161b2d;--surface2:#1b2140;--ink:#e8ecff;--muted:#9ca8d9;
      --stroke:#283056;--azure:#0078d4;--radius:14px;--shadow:0 12px 28px rgba(6,12,40,.45);
      --cta:linear-gradient(180deg,#76c7ff,#0078d4);
      --ok:#20d38a;--warn:#ffd76b;--bad:#ff6b6b;
      --p1:#6c8bff;--p2:#33d1ff;--p3:#ff7dd1;--p4:#a5ff7d;--p5:#ffb36b;
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:Inter,ui-sans-serif,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      color:var(--ink);
      background:
        radial-gradient(900px 420px at 90% -10%,rgba(0,120,212,.14),transparent 60%),
        radial-gradient(800px 400px at 10% 0%,rgba(0,120,212,.10),transparent 60%),
        var(--bg);
      line-height:1.6;overflow-x:hidden;
    }
    a{color:inherit;text-decoration:none}
    .container{max-width:1160px;margin:0 auto;padding:0 20px}

    /* HEADER */
    header{position:sticky;top:0;z-index:50;backdrop-filter:blur(10px);
      background:linear-gradient(180deg,rgba(15,19,32,.85),rgba(15,19,32,.55));border-bottom:1px solid var(--stroke)}
    .nav{height:64px;display:flex;align-items:center;justify-content:space-between;gap:10px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:900;text-transform:uppercase}
    .brand img.site-logo{height:42px;width:auto;display:block}
    nav.menu{display:flex;gap:16px;color:var(--muted);font-weight:800;align-items:center;text-transform:uppercase}
    nav.menu a.link-btn{display:inline-flex;align-items:center;justify-content:center;min-width:110px;min-height:44px;height:40px;padding:0 12px;border-radius:10px;border:1px solid transparent;font-weight:900}
    nav.menu a.link-btn:hover{border-color:#2a3150;color:var(--ink)}
    .authwrap{display:flex;align-items:center;gap:6px;background:linear-gradient(180deg,#151b31,#12182c); border:1px solid #2a3150;border-radius:999px; padding:4px; box-shadow:0 6px 18px rgba(5,10,30,.35); max-height:44px;}
    .hello{display:flex;align-items:center;gap:6px;color:#cbd3ff;font-weight:800;padding:4px 8px;font-size:12px}
    .pill-btn{display:inline-flex;align-items:center;justify-content:center;min-width:100px;min-height:44px;height:34px;padding:0 14px;border-radius:12px;border:1px solid #0078d455;background:var(--cta); color:#0b1930; font-weight:900; cursor:pointer;transition:transform .08s, filter .12s; font-size:13px;text-transform:uppercase;}
    .pill-btn:hover{filter:brightness(1.05); transform:translateY(-1px)}

    /* HERO */
    .hero{padding:22px 0 8px}
    .hero .eyebrow{display:inline-flex;align-items:center;gap:8px;font-weight:900;color:#cfe1ff;background:rgba(0,120,212,.15);
      border:1px solid rgba(0,120,212,.45);border-radius:999px;padding:6px 10px}
    .hero h1{margin:10px 0 10px;font-size:clamp(1.7rem,3.8vw,2.6rem);line-height:1.2}
    .hero p{color:var(--muted);max-width:900px}

    /* Tabs (botonera) */
    .tabbar{display:flex;gap:12px;margin-top:8px;flex-wrap:wrap}
    .tab-btn{
      display:inline-flex;align-items:center;gap:10px;justify-content:center;
      min-height:44px;padding:10px 16px;border-radius:12px;font-weight:900;cursor:pointer;
      border:1px solid #2a3150;background:transparent;color:#e8ecff;
    }
    .tab-btn.active{background:var(--cta);border-color:transparent;color:#0b1930;box-shadow:0 10px 22px rgba(0,120,212,.22)}

    /* ====== DOMINIOS & SIMULADOR ====== */
    .wrap{max-width:1160px;margin:0 auto;padding:0 20px}
    .grid-sim{display:grid;grid-template-columns:1.35fr .85fr;gap:16px;margin-top:16px}
    @media(max-width:860px){.grid-sim{grid-template-columns:1fr}}
    .panel{background:var(--surface);border:1px solid var(--stroke);border-radius:12px;padding:16px;box-shadow:var(--shadow)}
    .domains-list{list-style:none;padding-left:0;margin:0;display:grid;gap:12px}
    .dom-item{display:flex;align-items:center;gap:12px;border:1px solid var(--stroke);background:var(--surface2);border-radius:14px;padding:14px 16px;cursor:pointer}
    .dom-item:hover{border-color:#3a4883}
    .dom-item.active{outline:3px solid rgba(108,139,255,.28)}
    .dom-code{width:36px;height:36px;min-width:36px;display:grid;place-items:center;border-radius:999px;background:#0078d4;color:#fff;font-weight:900;letter-spacing:.2px;box-shadow:0 6px 14px rgba(0,120,212,.28)}
    .chip-dom{display:inline-flex;align-items:center;gap:8px;background:#0f1630;border:1px solid #313c6e;border-radius:999px;padding:6px 10px;font-weight:900;cursor:pointer}
    .chip-dom .led{width:10px;height:10px;border-radius:999px;background:transparent;border:2px solid #5c6bb2}
    .chip-dom.on{background:rgba(108,139,255,.14); border-color:#4a5cc3; box-shadow:0 0 0 2px rgba(108,139,255,.28) inset;}
    .chip-dom.on .led{background:#6c8bff; border-color:#6c8bff}

    /* Segmented base */
    .segmented{display:flex;gap:8px;background:var(--surface2);border:1px solid var(--stroke);border-radius:10px;padding:6px}
    .segmented input{display:none}
    .segmented label{flex:1;text-align:center;padding:8px 10px;border-radius:8px;cursor:pointer;font-weight:800}
    .segmented input:checked + label{background:#0f1630;border:1px solid #4c66c9}

    #startBtn{background:#0078d4;color:#0b0f22;border-color:transparent;box-shadow:0 10px 24px rgba(0,120,212,.35)}

    /* ====== Notas dominio enriquecidas ====== */
    #infoDom{margin-top:16px;background:linear-gradient(180deg,#0f1736,#0e1430);border:1px solid var(--stroke);border-radius:16px;padding:0;box-shadow:0 20px 42px rgba(0,0,0,.45);display:none;overflow:hidden}
    .info-head{display:flex;gap:10px;align-items:center;justify-content:space-between;background:
      radial-gradient(120% 120% at 100% -10%, rgba(0,120,212,.25), transparent 60%),
      linear-gradient(180deg, #121a48, #0f1437);padding:16px;border-bottom:1px solid #2a3b6d}
    .info-head h3{margin:0;font-size:1.2rem;letter-spacing:.2px}
    .info-body{padding:16px}
    .badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;font-weight:900;font-size:.78rem;border:1px solid rgba(255,255,255,.12);box-shadow:0 2px 0 rgba(0,0,0,.15)}
    .b1{background:linear-gradient(180deg,#7da1ff,#4a6dff)} .b2{background:linear-gradient(180deg,#49e2ff,#1bb3ff)}
    .b3{background:linear-gradient(180deg,#ff98dc,#ff56c1)} .b4{background:linear-gradient(180deg,#b9ff8b,#7dff56)}
    .b5{background:linear-gradient(180deg,#ffc98b,#ff9646)}
    .grid-2{display:grid;grid-template-columns:1.1fr .9fr;gap:14px}
    @media(max-width:860px){.grid-2{grid-template-columns:1fr}}
    .subcard{background:#0f1634;border:1px solid #2a3b6d;border-radius:12px;padding:12px}
    .subcard h4{margin:.2rem 0 .4rem;font-size:1rem}
    .kvs{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .kv{background:#0e1630;border:1px dashed #34407a;border-radius:10px;padding:8px}
    .kv b{display:block;font-size:.8rem;color:#cfe1ff}
    .kv span{font-size:.95rem}
    .callout{border-left:4px solid var(--p2);background:linear-gradient(180deg,#0f1938,#0d162f);padding:12px;border-radius:10px}
    .callout.warn{border-left-color:var(--warn)}
    .list-check li{margin:.22rem 0}
    .table{width:100%;border-collapse:separate;border-spacing:0 6px;font-size:.95rem}
    .table tr{background:#0e1630}
    .table td,.table th{padding:10px;border-top:1px solid #2a3b6d;border-bottom:1px solid #2a3b6d}
    .table th{background:#101a3f;text-align:left}
    .meter{position:relative;height:10px;border-radius:999px;background:#0b1225;border:1px solid var(--stroke);overflow:hidden}
    .meter>span{position:absolute;left:0;top:0;height:100%;width:0;transition:width .35s}
    .m-ok{background:#3ad97a} .m-warn{background:#ffd66b} .m-bad{background:#ff6b6b}

    /* ========= ESTILO ESPECIAL DEL SIMULADOR ========= */
    #simCard{
      position:relative;
      background:
        radial-gradient(95% 140% at 100% 0, rgba(0,120,212,.18), transparent 60%),
        linear-gradient(180deg,#111937,#0f1633);
      border:1px solid rgba(0,120,212,.45);
      box-shadow:
        0 0 0 1px rgba(55,149,229,.25) inset,
        0 22px 40px rgba(0,0,0,.55);
    }
    #simCard::after{
      content:""; position:absolute; inset:-6px; border-radius:16px; pointer-events:none;
      box-shadow:0 0 0 3px rgba(0,120,212,.25);
    }
    #simTitle{
      font-size:clamp(1.4rem,3.0vw,2.0rem);
      font-weight:900; line-height:1.2; letter-spacing:.2px;
      text-shadow:0 10px 28px rgba(0,120,212,.35);
      margin-bottom:6px;
    }
    #simCard .segmented{background:rgba(255,255,255,.04);border:1px solid #2a3b6d;padding:6px}
    #simCard .segmented input:checked + label{
      background:linear-gradient(180deg,#164d86,#0e3570);
      border:1px solid rgba(0,120,212,.55);
      box-shadow:0 0 0 2px rgba(0,120,212,.30) inset;
    }
    #simCard select{
      background:#0f1b3a;color:var(--ink);
      border:1px solid #2a3b6d;border-radius:10px;
      padding:10px 12px;font-weight:800;min-width:84px;
    }
    #simCard .chip-dom{
      padding:10px 14px;border-radius:999px;
      border-color:#2a3b6d;background:transparent;color:#d6e5ff;
      box-shadow:0 2px 0 rgba(0,0,0,.12);
    }
    #simCard .chip-dom.on{background:rgba(0,120,212,.08); border-color:#3a62b3; box-shadow:0 0 0 2px rgba(0,120,212,.22) inset;}
    #simCard .chip-dom .led{width:14px;height:14px;border:2px solid #6a78b4}
    #simCard .chip-dom.on .led{background:#0078d4;border-color:#0078d4}

    /* ===== RUTAS & CONTENIDO ===== */
    #routesContent{display:none;margin-top:14px}
    #routesContent.open{display:block}
    .routes-wrap{display:grid;gap:14px}
    .route-block{background:var(--surface);border:1px solid var(--stroke);border-radius:14px;padding:12px}
    .route-title{display:flex;align-items:center;gap:8px;font-weight:900}
    details.rc{background:var(--surface2);border:1px solid var(--stroke);border-radius:12px;padding:10px}
    details.rc summary{cursor:pointer;font-weight:900;list-style:none}
    details.rc summary::-webkit-details-marker{display:none}
    .num{display:inline-grid;place-items:center;width:20px;height:20px;border-radius:5px;background:#1e2a55;border:1px solid #33417a;font-weight:900;margin-right:6px}
    .routes-btn{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(180deg,#4fb7ff,#1e78d8);border:1px solid #3a84cb;border-radius:12px;padding:10px 14px;font-weight:900;color:#0b1430;box-shadow:0 12px 24px rgba(0,120,212,.3)}
    .content-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    @media(max-width:860px){.content-grid{grid-template-columns:1fr}}
    .content-card{background:var(--surface2);border:1px solid var(--stroke);border-radius:14px;padding:14px}
    .content-card h4{margin:0 0 6px}
    .tag{display:inline-flex;align-items:center;gap:6px;border:1px solid #2a3b6d;border-radius:999px;padding:6px 10px;margin-left:8px;font-weight:900;background:#0f1634}

    /* ===== Footer ===== */
    footer{border-top:1px solid var(--stroke);padding:28px 0 18px;color:#9ca8d9;background:
      radial-gradient(80% 100% at 90% -10%,rgba(0,120,212,.14),transparent 60%),
      linear-gradient(180deg,rgba(22,27,45,.6),rgba(22,27,45,.2));margin-top:22px}
    .f-grid{display:grid;gap:14px}
    @media(min-width:720px){.f-grid{grid-template-columns:1.2fr .8fr .8fr .8fr}}
    footer a{color:#cfe1ff}
    footer a:hover{text-decoration:underline}
    .footer-bottom{margin-top:12px;font-size:12px;text-align:left;color:#b8c3f0}
    .logo-pill{display:inline-block}

    /* ============ NUEVO: Nube de Conceptos (Tips de Estudio) ============ */
    #studyGuide{display:none;margin-top:14px}
    #studyGuide.open{display:block}
    .cloud-head{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
    .cloud-search{flex:1;min-width:240px}
    .cloud-search input{
      width:100%;padding:10px 12px;border-radius:12px;border:1px solid #2a3b6d;
      background:#0f1736;color:var(--ink);font-weight:700;letter-spacing:.2px;
    }
    .concept-cloud{
      margin-top:12px;
      display:flex;flex-wrap:wrap;gap:12px;align-items:flex-start
    }
    .bubble{
      position:relative;
      display:inline-flex;align-items:center;gap:10px;
      padding:10px 14px;border-radius:999px;cursor:pointer;
      background:linear-gradient(180deg,#11193a,#0f1633);
      border:1px solid #2a3b6d;color:#e8ecff;
      box-shadow:0 10px 18px rgba(0,0,0,.25), 0 0 0 2px rgba(0,120,212,.10) inset;
      transition:transform .18s ease, box-shadow .18s ease, background .18s ease, border-color .18s ease;
      will-change:transform;
      max-width:100%;
    }
    .bubble:hover{transform:translateY(-2px) scale(1.02);border-color:#3a62b3;box-shadow:0 14px 26px rgba(0,0,0,.35), 0 0 0 3px rgba(0,120,212,.18) inset}
    .bubble .dot{width:10px;height:10px;border-radius:999px;background:#6c8bff;box-shadow:0 0 0 4px rgba(108,139,255,.18)}
    .bubble .title{font-weight:900;white-space:nowrap}
    .bubble .blurb{display:none}
    .bubble .go{display:none;margin-left:2px}
    .bubble .go a{background:linear-gradient(180deg,#6c8bff,#3e64ff);border:1px solid #3b2fff55;color:#fff;padding:6px 10px;border-radius:10px;font-weight:900}
    /* al pasar hover se ‚Äúexpande‚Äù y muestra blurb y CTA */
    .bubble:hover .blurb, .bubble:focus-within .blurb{display:inline; color:#cbd6ff}
    .bubble:hover .go, .bubble:focus-within .go{display:inline-flex}
    /* tama√±os (peso visual) */
    .s-1{font-size:.88rem}
    .s-2{font-size:.98rem}
    .s-3{font-size:1.06rem}
    .s-4{font-size:1.18rem}
    /* animaci√≥n sutil de flotaci√≥n */
    @keyframes floaty{0%{transform:translateY(0)}50%{transform:translateY(-3px)}100%{transform:translateY(0)}}
    .bubble:nth-child(3n){animation:floaty 6s ease-in-out infinite}
    .bubble:nth-child(4n){animation:floaty 7.5s ease-in-out infinite .6s}
    .bubble:nth-child(5n){animation:floaty 8.5s ease-in-out infinite 1.1s}
    /* etiquetas */
    .mini-tag{margin-left:6px;border:1px solid #31407a;border-radius:999px;padding:2px 8px;font-size:.78rem;color:#bcd1ff;background:#0f1736}
  </style>
</head>
<body>
  <header role="banner">
    <div class="container nav">
      <div class="brand">
        <img class="site-logo" src="/assets/ithub-logo.svg" alt="ITHub: inicio">
      </div>
      <nav class="menu" aria-label="Navegaci√≥n principal">
        <a class="link-btn" href="/">HOME</a>
        <a class="link-btn" href="/content/content.html">CONTENIDOS</a>
        <a class="link-btn" href="/score/ranking.html">RANKING</a>
      </nav>
      <div class="authwrap" id="authWrap" aria-label="Acciones de sesi√≥n">
        <a id="btnLogin"  class="pill-btn" href="/login/login.html" role="button">LOGIN</a>
        <a id="btnSignup" class="pill-btn" href="/login/login.html#signup" role="button">REG√çSTRATE</a>
        <div id="userArea" style="display:none;align-items:center;gap:6px">
          <div class="hello">üëã <span id="userNameTop" style="font-weight:900">USER</span></div>
          <a class="pill-btn" href="/user/profile.html" role="button" style="background:linear-gradient(180deg,#ffcf6a,#ff9900);color:#111">PERFIL</a>
          <button id="btnLogout" class="pill-btn" type="button" style="background:linear-gradient(180deg,#ffcf6a,#ff9900);color:#111">LOGOUT</button>
        </div>
      </div>
    </div>
  </header>

  <main id="main">
    <!-- HERO -->
    <section class="hero">
      <div class="container">
        <span class="eyebrow">MICROSOFT AZURE ADMINISTRATOR ‚Äî ASSOCIATE (AZ-104)</span>
        <h1>Portada de la certificaci√≥n AZ-104</h1>
        <p>Domina la administraci√≥n de Azure: identidades, almacenamiento, c√≥mputo, redes y monitorizaci√≥n. Aqu√≠ tienes <b>Tips de Estudio</b>, <b>Dominios & Simulador</b> y <b>Rutas & Contenido</b>.</p>

        <!-- Botonera de pesta√±as -->
        <div class="tabbar" role="tablist" aria-label="Vistas de AZ-104">
          <button id="tabSim" class="tab-btn active" role="tab" aria-selected="true" aria-controls="domsim">üß≠ DOMINIOS & SIMULADOR</button>
          <button id="tabGuide" class="tab-btn" role="tab" aria-selected="false" aria-controls="studyGuide">üìò TIPS DE ESTUDIO</button>
          <button id="tabRoutes" class="tab-btn" role="tab" aria-selected="false" aria-controls="routesContent">üìã RUTAS & CONTENIDO</button>
        </div>

        <!-- ===== NUEVO: TIPS EN NUBE DE CONCEPTOS ===== -->
        <section id="studyGuide" aria-label="Gu√≠a de estudio AZ-104" role="tabpanel" aria-labelledby="tabGuide">
          <h2 class="sec-title" style="margin:10px 0 6px;text-transform:uppercase">Tips de estudio AZ-104</h2>
          <div class="cloud-head">
            <p class="muted" style="margin:0">Conceptos cortos y enlaces r√°pidos. Pasa el rat√≥n para ver el tip y pulsa para leer.</p>
            <div class="cloud-search"><input id="cloudSearch" type="search" placeholder="Filtrar por concepto‚Ä¶ (RBAC, Storage, VPN‚Ä¶)" aria-label="Filtrar tips"></div>
          </div>
          <div id="conceptCloud" class="concept-cloud" aria-live="polite"></div>
        </section>

        <!-- ===== RUTAS & CONTENIDO ===== -->
        <section id="routesContent" aria-label="Rutas y contenido clave" role="tabpanel" aria-labelledby="tabRoutes">
          <div class="routes-wrap">
            <!-- Rutas -->
            <div class="route-block">
              <div class="route-title">üß≠ Rutas de estudio sugeridas</div>
              <details class="rc" open>
                <summary>‚ñ∂ Plan 7 d√≠as (intensivo) ‚Äî AZ-104</summary>
                <div style="padding:10px 0 0 4px">
                  <div><span class="num">1</span><b>Fundamentos:</b> Entra ID, RBAC, suscripciones, Resource Groups.</div>
                  <div><span class="num">2</span><b>Redes:</b> VNets, subredes, NSG, VPN/ExpressRoute, Private Link/DNS.</div>
                  <div><span class="num">3</span><b>Storage:</b> cuentas v2, SAS, redundancia (LRS/GRS), lifecycle.</div>
                  <div><span class="num">4</span><b>Compute:</b> VM/VMSS, im√°genes, actualizaciones autom√°ticas, availability zones.</div>
                  <div><span class="num">5</span><b>Observabilidad & Seguridad:</b> Monitor, Defender for Cloud, Key Vault.</div>
                  <div><span class="num">6</span><b>Datos:</b> SQL/Cosmos, Backup, Site Recovery (ASR).</div>
                  <div><span class="num">7</span><b>Simulacros + repaso dirigido:</b> errores frecuentes.</div>
                </div>
              </details>
              <details class="rc">
                <summary>‚ñ∂ Plan 14 d√≠as ‚Äî AZ-104</summary>
                <div style="padding:10px 0 0 4px">Divide el plan de 7 d√≠as en sprints de 2 d√≠as por bloque + 4 sesiones de pr√°ctica.</div>
              </details>
              <details class="rc">
                <summary>‚ñ∂ Plan 30 d√≠as ‚Äî de Cero a Associate</summary>
                <div style="padding:10px 0 0 4px">Profundiza en cada dominio con laboratorios y pol√≠ticas; a√±ade 6 simulacros completos.</div>
              </details>
              <div style="margin-top:10px">
                <button class="routes-btn" type="button" disabled>üíæ Descargar checklist (pr√≥x.)</button>
              </div>
            </div>

            <!-- Contenido clave -->
            <div class="route-block">
              <div class="route-title">üìö Contenido clave (res√∫menes y hojas de trucos)</div>
              <div class="content-grid" style="margin-top:8px">
                <div class="content-card">
                  <h4>Alta disponibilidad en redes</h4>
                  <p class="muted" style="margin:6px 0 10px">Zonas de disponibilidad, LB, escalado y patrones de resiliencia.</p>
                  <div>
                    <a class="tiny-btn" href="/content/azure-network-security-az104.html">LEER</a>
                    <span class="tag">Redes</span>
                  </div>
                </div>
                <div class="content-card">
                  <h4>Storage: seguridad y costes</h4>
                  <p class="muted" style="margin:6px 0 10px">SAS, RBAC, redundancia, lifecycle y acceso privado.</p>
                  <div>
                    <a class="tiny-btn" href="/content/azure-storage-az104.html">LEER</a>
                    <span class="tag">Storage</span>
                  </div>
                </div>
                <div class="content-card">
                  <h4>Landing Zone y gobernanza</h4>
                  <p class="muted" style="margin:6px 0 10px">CAF, Policy, RBAC, segmentaci√≥n y Bicep.</p>
                  <div>
                    <a class="tiny-btn" href="/content/azure-landing-zone.html">LEER</a>
                    <span class="tag">Gobernanza</span>
                  </div>
                </div>
                <div class="content-card">
                  <h4>Backup inmutable y ciber-recuperaci√≥n</h4>
                  <p class="muted" style="margin:6px 0 10px">WORM, cuentas aisladas, drills y vault.</p>
                  <div>
                    <a class="tiny-btn" href="/content/immutable-backup-cyberrecovery.html">LEER</a>
                    <span class="tag">Seguridad</span>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </section>
      </div>
    </section>

    <!-- ===== DOMINIOS & SIMULADOR ===== -->
    <section id="domsim" role="tabpanel" aria-labelledby="tabSim">
      <div class="wrap">
        <div class="grid-sim">
          <!-- IZQUIERDA: dominios -->
          <section class="panel" id="leftInfo">
            <div style="display:flex;gap:16px;align-items:flex-start;flex-wrap:wrap">
              <img id="provLogo" alt="Azure" style="width:66px;height:auto">
              <div id="provText" style="color:var(--muted)">Dominios oficiales y notas r√°pidas por tema.</div>
            </div>

            <h2 style="margin-top:14px">Dominios del examen</h2>
            <p class="muted" style="margin-top:-6px"><em>Haz clic en un dominio para abrir notas √∫tiles abajo.</em></p>

            <ul id="domainsList" class="domains-list"></ul>
          </section>

          <!-- DERECHA: simulador (remarcado) -->
          <aside class="panel" id="simCard" aria-label="Simulador AZ-104">
            <h3 id="simTitle">AZ-104 ¬∑ Simulador de examen</h3>

            <div class="field">
              <label>Modo</label>
              <div class="segmented" id="modeSeg">
                <input type="radio" id="modePractice" name="mode" value="practice" checked>
                <label for="modePractice">Pr√°ctica</label>
                <input type="radio" id="modeExam" name="mode" value="exam" disabled>
                <label for="modeExam" class="disabled" title="Modo examen pr√≥ximamente">Examen</label>
              </div>
            </div>

            <div class="field" style="margin-top:10px">
              <label>Preguntas</label>
              <select id="qCount">
                <option>5</option><option>10</option><option>15</option><option>30</option><option>65</option>
              </select>
            </div>

            <div class="field" style="margin-top:10px">
              <label>Dominios (filtro opcional)</label>
              <div id="domainChips" style="display:flex;flex-wrap:wrap;gap:10px"></div>
              <div style="color:var(--muted)">D√©jalo vac√≠o para incluir todos los dominios.</div>
            </div>

            <div class="field" style="margin-top:14px">
              <button id="startBtn" class="pill-btn" type="button">‚ñ∂ Empezar</button>
            </div>

            <div class="field" style="margin-top:6px;color:var(--muted)">
              Atajos:
              <span style="display:inline-flex;align-items:center;justify-content:center;min-width:28px;padding:2px 8px;border-radius:8px;background:#0f1a36;border:1px solid #2a3b6d;font-weight:900">N</span> Siguiente,
              <span style="display:inline-flex;align-items:center;justify-content:center;min-width:28px;padding:2px 8px;border-radius:8px;background:#0f1a36;border:1px solid #2a3b6d;font-weight:900">B</span> Anterior,
              <span style="display:inline-flex;align-items:center;justify-content:center;min-width:28px;padding:2px 8px;border-radius:8px;background:#0f1a36;border:1px solid #2a3b6d;font-weight:900">M</span> Marcar,
              <span style="display:inline-flex;align-items:center;justify-content:center;min-width:28px;padding:2px 8px;border-radius:8px;background:#0f1a36;border:1px solid #2a3b6d;font-weight:900">1-9</span> elegir.
            </div>
          </aside>
        </div>

        <!-- Notas del dominio -->
        <section id="infoDom" class="panel" aria-live="polite">
          <div class="info-head">
            <h3 id="infoTitle" style="margin:0">Notas del dominio</h3>
            <button id="infoClose" class="pill-btn" type="button">‚úñ Cerrar</button>
          </div>
          <div id="infoContent" class="info-body">
            <div class="info-empty">Selecciona un dominio para ver notas ampliadas, mapas mentales, gotchas y escenarios de examen.</div>
          </div>
        </section>

        <!-- √Årea de preguntas -->
        <main id="view" class="wrap" style="padding:0"></main>
      </div>
    </section>
  </main>

  <!-- Pie -->
  <footer role="contentinfo">
    <div class="container f-grid">
      <div>
        <div class="brand" style="text-transform:none">
          <span class="logo-pill" aria-hidden="true" style="width:18px;height:34px;border-radius:10px;background:linear-gradient(180deg,#8fd0ff 0%,#0078d4 100%);box-shadow:0 0 0 6px rgba(0,120,212,.18)"></span>
          <span>ITHub.es</span>
        </div>
        <p style="margin:8px 0 0;">Aprende, practica y aprueba tus certificaciones mientras compites con el resto del mundo.</p>
      </div>
      <div>
        <div style="font-weight:800">Simuladores</div>
        <div><a href="/certification/microsoft-azure/az-104/lz-azure-az-104.html">AZ-104</a></div>
        <div><a href="/certification/amazon aws/aws-saa-c03/lz-aws-saa-c03.html">SAA-C03</a></div>
        <div><a href="/certification/microsoft-azure/az-305/lz-azure-az-305.html">AZ-305</a></div>
      </div>
      <div>
        <div style="font-weight:800">Contenidos</div>
        <div><a href="/content/azure-storage-az104.html">Azure ¬∑ Storage (AZ-104)</a></div>
        <div><a href="/content/azure-landing-zone.html">Azure ¬∑ Landing Zone</a></div>
        <div><a href="/content/azure-hybrid-connectivity-az305.html">Azure ¬∑ Conectividad h√≠brida</a></div>
      </div>
      <div>
        <div style="font-weight:800">Contacto</div>
        <button id="footerContactBtn" type="button"
                style="background:none;border:none;color:#cfe1ff;font-weight:800;display:inline-flex;align-items:center;gap:6px;cursor:pointer;padding:0;margin-top:6px;">
          üí¨ <span>Cont√°ctanos</span>
        </button>
      </div>
    </div>
    <div class="container footer-bottom">¬© <span id="y"></span> ITHub.es</div>
  </footer>

  <!-- Modal resultados (oculto por defecto) -->
  <div class="modal" id="quizResultModal" aria-hidden="true" style="display:none;">
    <div class="modal-card">
      <h3>üìä Resultados del examen</h3>
      <div id="quizScoreBox" class="panel" style="padding:12px;margin:0 0 12px;background:var(--surface2)">
        <strong id="quizScoreText">Puntuaci√≥n</strong>
      </div>
      <div id="quizDomainsGrid" class="diag-grid"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
        <button class="pill-btn" id="qrClose">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Motor del simulador -->
  <script src="/control_quizs/Q_global_dark.js" defer></script>

  <script>
    // A√±o
    document.getElementById('y').textContent = new Date().getFullYear();

    /* ===== AUTH header ===== */
    function getCurrentUser(){ try{ return JSON.parse(localStorage.getItem("currentUser")||"null"); }catch{ return null; } }
    function renderHeaderAuth(){
      const u=getCurrentUser();
      const login=document.getElementById('btnLogin');
      const signup=document.getElementById('btnSignup');
      const userArea=document.getElementById('userArea');
      const nameTop=document.getElementById('userNameTop');
      if(u){ login.style.display='none'; signup.style.display='none'; userArea.style.display='flex'; nameTop.textContent=(u.name||u.email||'USER').toUpperCase(); }
      else{ login.style.display='inline-flex'; signup.style.display='inline-flex'; userArea.style.display='none'; }
    }
    document.getElementById('btnLogout')?.addEventListener('click', ()=>{ localStorage.removeItem('currentUser'); renderHeaderAuth(); });
    renderHeaderAuth();

    /* ===== Tabs ===== */
    const tabSim   = document.getElementById('tabSim');
    const tabGuide = document.getElementById('tabGuide');
    const tabRoutes= document.getElementById('tabRoutes');
    const secSim   = document.getElementById('domsim');
    const secGuide = document.getElementById('studyGuide');
    const secRoutes= document.getElementById('routesContent');

    function showSection(which){
      const isGuide  = which === 'guide';
      const isRoutes = which === 'routes';

      tabGuide.classList.toggle('active', isGuide);
      tabGuide.setAttribute('aria-selected', isGuide ? 'true' : 'false');

      tabRoutes.classList.toggle('active', isRoutes);
      tabRoutes.setAttribute('aria-selected', isRoutes ? 'true' : 'false');

      const isSim = !isGuide && !isRoutes;
      tabSim.classList.toggle('active', isSim);
      tabSim.setAttribute('aria-selected', isSim ? 'true' : 'false');

      secGuide.classList.toggle('open', isGuide);
      secGuide.style.display  = isGuide ? 'block' : 'none';

      secRoutes.classList.toggle('open', isRoutes);
      secRoutes.style.display = isRoutes ? 'block' : 'none';

      secSim.style.display    = isSim ? 'block' : 'none';

      (isGuide ? secGuide : (isRoutes ? secRoutes : secSim))
        .scrollIntoView({behavior:'smooth', block:'start'});
    }

    tabGuide.addEventListener('click', ()=>showSection('guide'));
    tabSim  .addEventListener('click', ()=>showSection('sim'));
    tabRoutes.addEventListener('click', ()=>showSection('routes'));

    /* ===== DATA de contenidos (se reutiliza para la nube) ===== */
    const QUIZ = 'az-104';
    const CONTENT = {
      'az-104': [
        { slug: 'azure-identity-az104',              title: 'Identidad y RBAC',               blurb: 'Entra ID, grupos, PIM, MFA y m√≠nimo privilegio.' },
        { slug: 'azure-storage-az104',               title: 'Azure Storage',                  blurb: 'Cuentas, SAS, replicaci√≥n LRS‚ÄìGZRS, inmutabilidad.' },
        { slug: 'azure-network-security-az104',      title: 'Seguridad de red',               blurb: 'NSG/ASG, UDR, Firewall, Private Endpoints.' },
        { slug: 'azure-monitoring-alerts-az104',     title: 'Monitorizaci√≥n',                 blurb: 'Log Analytics, m√©tricas/alertas, action groups.' },
        { slug: 'azure-compute-availability-az104',  title: 'Compute & HA',                   blurb: 'VMSS, Availability Sets/Zones, im√°genes, discos.' },
        { slug: 'azure-backup-recovery-az104',       title: 'Backup & Recovery',              blurb: 'Vaults, pol√≠ticas, snapshots, restauraci√≥n.' },
        { slug: 'azure-cost-governance-az104',       title: 'Coste & Gobierno',               blurb: 'Budgets, tags, Azure Policy, locks.' },
        { slug: 'azure-landing-zone',                title: 'Landing Zone',                   blurb: 'Estructura de suscripciones y pol√≠ticas base.' },
        { slug: 'azure-security-checklist',          title: 'Checklist seguridad',            blurb: 'MFA, Secure Score, Defender for Cloud.' },
        { slug: 'vnet-peering-vpn',                  title: 'Peering vs. VPN',                blurb: 'Cu√°ndo peering y cu√°ndo VPN Gateway.' }
      ]
    };

    /* ===== Render de la NUBE de conceptos ===== */
    (function renderConceptCloud(){
      const items = CONTENT[QUIZ] || [];
      const cloud = document.getElementById('conceptCloud');
      const weights = ['s-1','s-2','s-3','s-4'];

      cloud.innerHTML = items.map((it,i)=> {
        const size = weights[(i % weights.length)];
        const tag  = (i%2===0?'AZ-104':'AZURE'); // mini etiqueta alterna
        return `
          <div class="bubble ${size}" tabindex="0" data-title="${it.title.toLowerCase()}" data-blurb="${it.blurb.toLowerCase()}">
            <span class="dot" aria-hidden="true"></span>
            <span class="title">${it.title}</span>
            <span class="mini-tag">${tag}</span>
            <span class="blurb"> ¬∑ ${it.blurb}</span>
            <span class="go"><a href="/content/${it.slug}.html" aria-label="Leer ${it.title}">Leer ‚Üí</a></span>
          </div>
        `;
      }).join('');
    })();

    /* ===== Filtro de b√∫squeda en la nube ===== */
    (function(){
      const input = document.getElementById('cloudSearch');
      const cloud = document.getElementById('conceptCloud');
      input.addEventListener('input', ()=>{
        const q = input.value.trim().toLowerCase();
        cloud.querySelectorAll('.bubble').forEach(b=>{
          const hit = b.dataset.title.includes(q) || b.dataset.blurb.includes(q);
          b.style.display = hit ? 'inline-flex' : 'none';
        });
      });
    })();

    /* ===== Config dominios ===== */
    const CONFIG = {
      'az-104': {
        logo: 'https://upload.wikimedia.org/wikipedia/commons/a/a8/Microsoft_Azure_Logo.svg',
        blurb: 'Dominios oficiales de AZ-104 con notas r√°pidas para el examen.',
        domains: [
          ['D1','Administrar identidades y gobierno (15‚Äì20%)'],
          ['D2','Implementar y administrar almacenamiento (15‚Äì20%)'],
          ['D3','Desplegar y administrar c√≥mputo (20‚Äì25%)'],
          ['D4','Configurar y administrar redes (20‚Äì25%)'],
          ['D5','Monitorizar y mantener recursos (10‚Äì15%)']
        ]
      }
    };
    const DOMAIN_FILES = {
      'az-104': {
        D1:'/tips/azure-az104-tips-domain1.html',
        D2:'/tips/azure-az104-tips-domain2.html',
        D3:'/tips/azure-az104-tips-domain3.html',
        D4:'/tips/azure-az104-tips-domain4.html',
        D5:'/tips/azure-az104-tips-domain5.html'
      }
    };

    /* ===== Contenido ampliado inline ===== */
    const DOMAINS_CONTENT = {
      D1:{colorClass:'b1',title:'D1 ‚Äî Administrar identidades y gobierno (15‚Äì20%)',html:`
        <div class="grid-2">
          <div class="subcard">
            <h4>Qu√© pide el examen</h4>
            <ul class="list-check">
              <li>Gestionar <b>Entra ID</b>: usuarios, grupos, asignaciones y licencias.</li>
              <li>Aplicar <b>RBAC</b> en √°mbito correcto (RG ‚Üí suscripci√≥n ‚Üí MG).</li>
              <li><b>MFA</b> y <b>Conditional Access</b> (CA) para escenarios t√≠picos.</li>
              <li><b>PIM</b> para roles JIT y revisiones de acceso.</li>
              <li><b>Azure Policy</b>, <b>tags</b>, <b>locks</b> y principios de <b>Blueprint</b>.</li>
            </ul>
          </div>
          <div class="subcard">
            <h4>Atajos mentales</h4>
            <div class="kvs">
              <div class="kv"><b>Owner</b><span>Control total + RBAC</span></div>
              <div class="kv"><b>Contributor</b><span>Control sin asignar RBAC</span></div>
              <div class="kv"><b>User Access Admin</b><span>Gestiona RBAC</span></div>
              <div class="kv"><b>Reader</b><span>Solo lectura</span></div>
            </div>
          </div>
        </div>
        <div class="subcard" style="margin-top:12px">
          <h4>Escenarios t√≠picos</h4>
          <table class="table">
            <tr><th>Escenario</th><th>Respuesta esperada</th></tr>
            <tr><td>Permisos Dev en un RG concreto</td><td><b>Contributor</b> al <b>grupo</b> en el <b>RG</b>.</td></tr>
            <tr><td>Revisi√≥n de accesos mensual</td><td><b>PIM</b> + <b>Access Reviews</b> + JIT + MFA.</td></tr>
            <tr><td>Restringir regiones</td><td><b>Azure Policy</b> Allowed locations en suscripci√≥n.</td></tr>
            <tr><td>Evitar borrado de RG</td><td><b>Lock</b> CanNotDelete en RG.</td></tr>
          </table>
          <div class="callout warn"><b>Gotchas:</b> RBAC ‚â† roles de AAD; CA requiere licencias; MG deben estar habilitados.</div>
        </div>
      `},
      D2:{colorClass:'b2',title:'D2 ‚Äî Implementar y administrar almacenamiento (15‚Äì20%)',html:`
        <div class="grid-2">
          <div class="subcard">
            <h4>Claves</h4>
            <ul class="list-check">
              <li>Tipos de cuenta: <b>StorageV2</b>, <b>Premium</b>, <b>HNS</b> (ADLS Gen2).</li>
              <li>Replicaci√≥n: <b>LRS</b>, <b>ZRS</b>, <b>GRS</b>, <b>GZRS</b> (+RA).</li>
              <li>Seguridad: <b>Private Endpoints</b>, <b>Firewall</b>, <b>CMK</b>, <b>SAS</b>, <b>RBAC</b>.</li>
              <li>Inmutabilidad: <b>Time-based</b>, <b>Legal hold</b>, versioning y soft delete.</li>
              <li>AzCopy, Import/Export, Lifecycle, Azure Files + AD.</li>
            </ul>
          </div>
          <div class="subcard">
            <h4>Elecci√≥n r√°pida</h4>
            <div class="kvs">
              <div class="kv"><b>DL Gen2</b><span>HNS + ACL POSIX</span></div>
              <div class="kv"><b>GZRS</b><span>HA regional + zona</span></div>
              <div class="kv"><b>Private EP</b><span>Tr√°fico privado</span></div>
              <div class="kv"><b>UD SAS</b><span>Delegaci√≥n con Entra ID</span></div>
            </div>
          </div>
        </div>
        <div class="subcard" style="margin-top:12px">
          <h4>Escenarios</h4>
          <table class="table">
            <tr><th>Escenario</th><th>Soluci√≥n</th></tr>
            <tr><td>Anal√≠tica con jerarqu√≠a</td><td><b>ADLS Gen2</b> (HNS)</td></tr>
            <tr><td>Solo red interna</td><td><b>Private Endpoint</b> + deshabilitar public access</td></tr>
            <tr><td>WORM 7 a√±os</td><td><b>Inmutabilidad time-based</b> + versioning</td></tr>
            <tr><td>Copiar 10 TB</td><td><b>AzCopy</b> / <b>Import/Export</b></td></tr>
            <tr><td>SMB con AD</td><td><b>Azure Files</b> + AD DS / Entra DS</td></tr>
          </table>
        </div>
      `},
      D3:{colorClass:'b3',title:'D3 ‚Äî Desplegar y administrar c√≥mputo (20‚Äì25%)',html:`
        <div class="grid-2">
          <div class="subcard">
            <h4>Temario</h4>
            <ul class="list-check">
              <li>VMs, Managed Disks, extensiones, cifrado.</li>
              <li>HA: <b>Availability Sets</b>, <b>Zones</b>, <b>VMSS</b>.</li>
              <li>Im√°genes (SIG), cloud-init, actualizaciones.</li>
              <li>App Service b√°sico / contenedores.</li>
              <li>Automatizaci√≥n: ARM/Bicep y Update Management.</li>
            </ul>
          </div>
          <div class="subcard">
            <h4>Decisiones</h4>
            <div class="kvs">
              <div class="kv"><b>Zones</b><span>Resiliencia multi-DC</span></div>
              <div class="kv"><b>ASets</b><span>FD/UD cl√°sico</span></div>
              <div class="kv"><b>VMSS</b><span>Escala + upgrades</span></div>
              <div class="kv"><b>SIG</b><span>Cat√°logo im√°genes</span></div>
            </div>
          </div>
        </div>
        <div class="subcard" style="margin-top:12px">
          <h4>Escenarios</h4>
          <table class="table">
            <tr><th>Escenario</th><th>Soluci√≥n</th></tr>
            <tr><td>RTO bajo + zonas</td><td>VMs en <b>AZ</b> + <b>Standard LB</b></td></tr>
            <tr><td>Web sin downtime</td><td><b>App Service</b> + <b>deployment slots</b></td></tr>
            <tr><td>Golden image multi-sub</td><td><b>Shared Image Gallery</b></td></tr>
            <tr><td>Parcheo mensual</td><td><b>Update Management</b></td></tr>
          </table>
        </div>
      `},
      D4:{colorClass:'b4',title:'D4 ‚Äî Configurar y administrar redes (20‚Äì25%)',html:`
        <div class="grid-2">
          <div class="subcard">
            <h4>Lo esencial</h4>
            <ul class="list-check">
              <li>VNet, subnets, <b>NSG/ASG</b>, <b>UDR</b>, DNS privado.</li>
              <li>Peering, <b>VPN S2S</b>, <b>ExpressRoute</b>.</li>
              <li>Balanceo: <b>Standard LB</b> (L4), <b>App Gateway</b> (L7, WAF).</li>
              <li>Privacidad: <b>Private Link</b> vs Service Endpoints.</li>
              <li>Firewall, NAT Gateway, DDoS, Bastion.</li>
            </ul>
          </div>
          <div class="subcard">
            <h4>Elecci√≥n r√°pida</h4>
            <div class="kvs">
              <div class="kv"><b>Peering</b><span>Baja latencia</span></div>
              <div class="kv"><b>VPN</b><span>IPsec sobre Internet</span></div>
              <div class="kv"><b>ER</b><span>Privado, SLA, BW alto</span></div>
              <div class="kv"><b>Private EP</b><span>IP privada a PaaS</span></div>
            </div>
          </div>
        </div>
      `},
      D5:{colorClass:'b5',title:'D5 ‚Äî Monitorizar y mantener recursos (10‚Äì15%)',html:`
        <div class="grid-2">
          <div class="subcard">
            <h4>Qu√© entra</h4>
            <ul class="list-check">
              <li><b>Azure Monitor</b>: m√©tricas vs logs; <b>Log Analytics</b>.</li>
              <li>Alertas de m√©tricas/log/Activity; <b>Action Groups</b>.</li>
              <li>VM/Container Insights, App Insights b√°sico.</li>
              <li><b>Update Management</b> y Change Tracking.</li>
              <li>Secure Score (Defender for Cloud).</li>
            </ul>
          </div>
          <div class="subcard">
            <h4>Atajos</h4>
            <div class="kvs">
              <div class="kv"><b>M√©trica</b><span>Near real time</span></div>
              <div class="kv"><b>Log</b><span>KQL</span></div>
              <div class="kv"><b>AG</b><span>Email/webhook/ITSM</span></div>
              <div class="kv"><b>Insights</b><span>Perf + dependencias</span></div>
            </div>
          </div>
        </div>
      `}
    };

    /* ===== chips/domains + notas ===== */
    const badgeLogo=document.getElementById('provLogo'),
          provText=document.getElementById('provText'),
          dlist=document.getElementById('domainsList'),
          chips=document.getElementById('domainChips'),
          startBtn=document.getElementById('startBtn'),
          qCount=document.getElementById('qCount'),
          infoDom=document.getElementById('infoDom'),
          infoTitle=document.getElementById('infoTitle'),
          infoContent=document.getElementById('infoContent'),
          view=document.getElementById('view');

    const cfg = CONFIG[QUIZ];
    badgeLogo.src = cfg.logo; badgeLogo.alt = 'Azure';
    provText.textContent = cfg.blurb;

    dlist.innerHTML = cfg.domains.map(([d,txt],i) =>
      `<li class="dom-item" data-dn="${d}">
         <span class="dom-code">${d}</span>
         <span class="dom-title">${txt}</span>
         <span class="badge ${['b1','b2','b3','b4','b5'][i]}">${txt.split('(')[1]||''}</span>
       </li>`).join('');

    chips.innerHTML = cfg.domains.map(([d]) =>
      `<label class="chip-dom" data-dn="${d}">
         <input type="checkbox" value="${d}" hidden>
         <span class="led"></span> <span style="font-weight:900">${d}</span>
       </label>`).join('');

    function updateChipVisuals(){
      chips.querySelectorAll('.chip-dom').forEach(lbl=>{
        const cb = lbl.querySelector('input[type="checkbox"]');
        lbl.classList.toggle('on', !!cb.checked);
      });
    }
    chips.addEventListener('click', (ev)=>{
      const wrap = ev.target.closest('.chip-dom'); if(!wrap) return;
      const cb = wrap.querySelector('input[type="checkbox"]'); cb.checked = !cb.checked; updateChipVisuals();
    });
    updateChipVisuals();

    dlist.addEventListener('click', (ev)=>{
      const li = ev.target.closest('.dom-item'); if(!li) return;
      dlist.querySelectorAll('.dom-item').forEach(x=>x.classList.remove('active'));
      li.classList.add('active');
      loadDomainNotes(li.dataset.dn);
    });

    function renderDomainInline(code){
      const data = DOMAINS_CONTENT[code];
      if(!data) return false;
      infoTitle.innerHTML = `<span class="badge ${data.colorClass}">${code}</span> ${data.title}`;
      infoContent.innerHTML = data.html;
      infoDom.style.display = 'block';
      infoDom.scrollIntoView({behavior:'smooth', block:'start'});
      return true;
    }

    async function loadDomainNotes(domainCode){
      if (renderDomainInline(domainCode)) return;

      const map = (DOMAIN_FILES[QUIZ]||{});
      const file = map[domainCode];
      infoTitle.textContent = `${domainCode} ‚Äî Notas`;
      infoDom.style.display = 'block';
      infoContent.innerHTML = `<div class="info-empty">Cargando notas‚Ä¶</div>`;
      if(!file){ infoContent.innerHTML = `<div class="info-empty">No hay archivo de notas asignado para <b>${domainCode}</b>.</div>`; return; }
      try{
        const res = await fetch(file, {cache:'no-store'});
        const html = await res.text();
        const doc = new DOMParser().parseFromString(html, 'text/html');
        doc.querySelectorAll('script,link').forEach(n=>n.remove());
        const src = doc.querySelector('.wrap') || doc.body;
        infoContent.innerHTML = src ? src.innerHTML : html;
        infoDom.scrollIntoView({behavior:'smooth', block:'start'});
      }catch(e){
        infoContent.innerHTML = `<div class="info-empty">No se pudieron cargar las notas de <b>${domainCode}</b>.</div>`;
      }
    }
    document.getElementById('infoClose').addEventListener('click', ()=>{ infoDom.style.display='none'; });

    // Simulador
    let quizActive = false;
    const header = document.querySelector('header');
    function smoothScrollTo(el){
      if(!el) return;
      const rect = el.getBoundingClientRect();
      const offset = (header?header.offsetHeight:0)+10;
      const top = rect.top + window.scrollY - offset;
      window.scrollTo({ top, behavior:'smooth' });
    }
    function setQuizActive(on){
      quizActive = !!on;
      startBtn.disabled = quizActive;
      startBtn.textContent = quizActive ? '‚è≥ En marcha‚Ä¶' : '‚ñ∂ Empezar';
      startBtn.setAttribute('aria-disabled', quizActive ? 'true' : 'false');
    }
    function waitForQuizMount(timeout=4000){
      return new Promise(resolve=>{
        if (view.children.length>0) return resolve();
        const obs = new MutationObserver(()=>{ if(view.children.length>0){ obs.disconnect(); resolve(); }});
        obs.observe(view,{childList:true});
        setTimeout(()=>{ obs.disconnect(); resolve(); }, timeout);
      });
    }
    window.addEventListener('quiz:started', ()=>{ setQuizActive(true); smoothScrollTo(document.querySelector('#view .question-card')||view); });
    window.addEventListener('quiz:ended',   ()=>{ setQuizActive(false); });

    startBtn.addEventListener('click', async ()=>{
      if (quizActive) return;
      if (infoDom.style.display !== 'none') { infoDom.style.display='none'; }
      const count = parseInt(qCount.value,10) || 65;
      const tags = Array.from(chips.querySelectorAll('input[type="checkbox"]:checked')).map(cb=>cb.value);
      if(typeof window.start === 'function'){
        setQuizActive(true);
        window.start(QUIZ, { count, tags });
        await waitForQuizMount();
        smoothScrollTo(document.querySelector('#view .question-card')||view);
      }else{
        setQuizActive(false);
        alert('Motor de simulador no cargado.');
      }
    });

    /* ===== Resultados modal (OCULTO por defecto) ===== */
    const qrModal = document.getElementById('quizResultModal');
    const qrClose = document.getElementById('qrClose');
    const qrGrid  = document.getElementById('quizDomainsGrid');
    const qrScore = document.getElementById('quizScoreText');
    function percent(a,b){ return b ? Math.round((a/b)*100) : 0; }
    function barClass(p){ return p<50?'m-bad':(p<75?'m-warn':'m-ok'); }
    function showResultsModal(data){
      const s = Number(data?.score||0), t = Number(data?.total||0);
      qrScore.textContent = `Puntuaci√≥n: ${s}/${t} (${percent(s,t)}%)`;
      qrGrid.innerHTML = '';
      const byDom = data?.byDomain || null;
      if(byDom && Object.keys(byDom).length){
        Object.entries(byDom).forEach(([code,info])=>{
          const p = percent(info.correct, info.total);
          const card = document.createElement('div');
          card.className = 'panel';
          card.style.padding='12px';
          card.style.background='var(--surface2)';
          card.innerHTML = `
            <div style="font-weight:900;margin-bottom:6px">${info.name||code}</div>
            <div class="meter"><span class="${barClass(p)}" style="width:${p}%"></span></div>
            <div style="color:var(--muted);margin-top:6px">${info.correct}/${info.total} aciertos ¬∑ ${p}%</div>
          `;
          qrGrid.appendChild(card);
        });
      }
      qrModal.classList.add('show');
      qrModal.style.display = 'flex';
    }
    qrClose.addEventListener('click', ()=>{ qrModal.classList.remove('show'); qrModal.style.display='none'; });
    qrModal.addEventListener('click', (e)=>{ if(e.target===qrModal){ qrModal.classList.remove('show'); qrModal.style.display='none'; } });
    window.quizResults = showResultsModal;
    window.addEventListener('quiz:results', (e)=> showResultsModal(e.detail||{}));
  </script>
</body>
</html>
