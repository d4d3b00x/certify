<!doctype html>
<html lang="es">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DYZ3GCXHEK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    gtag('js', new Date());
    gtag('config', 'G-DYZ3GCXHEK');
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0f1320" />

  <title>AZ-305: Simulador y Gu√≠a de Estudio ‚Äî Azure Solutions Architect Expert | ITHub</title>
  <link rel="canonical" href="https://beta.ithub.es/certification/microsoft-azure/az-305/lz-azure-az-305.html" />
  <meta name="description" content="Simulador AZ-305 con preguntas por dominios (D1-D4), m√©tricas y gu√≠a de estudio en tarjetas. Practica Designing Microsoft Azure Infrastructure Solutions y supera 700/1000." />
  <meta name="keywords" content="AZ-305, simulador AZ-305, preguntas AZ-305 en espa√±ol, Azure Solutions Architect Expert, gu√≠a de estudio AZ-305, dominios D1 D2 D3 D4" />

  <style>
    :root{ --bg:#0f1320;--surface:#161b2d;--surface2:#1b2140;--ink:#e8ecff;--muted:#9ca8d9;--stroke:#283056;--azure:#0078d4;--radius:14px;--shadow:0 12px 28px rgba(6,12,40,.45);--cta:linear-gradient(180deg,#76c7ff,#0078d4); }
    *{box-sizing:border-box}
    body{ margin:0;font-family:Inter,ui-sans-serif,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; color:var(--ink); background: radial-gradient(900px 420px at 90% -10%,rgba(0,120,212,.14),transparent 60%), radial-gradient(800px 400px at 10% 0%,rgba(0,120,212,.10),transparent 60%), var(--bg); line-height:1.6;overflow-x:hidden; }
    a{color:inherit;text-decoration:none}
    .container{max-width:1160px;margin:0 auto;padding:0 20px}

    /* HEADER */
    header{position:sticky;top:0;z-index:50;backdrop-filter:blur(10px); background:linear-gradient(180deg,rgba(15,19,32,.85),rgba(15,19,32,.55));border-bottom:1px solid var(--stroke)}
    .nav{height:64px;display:flex;align-items:center;justify-content:space-between;gap:10px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:900;text-transform:uppercase}
    .brand img.site-logo{height:42px;width:auto;display:block}
    nav.menu{display:flex;gap:16px;color:var(--muted);font-weight:800;align-items:center;text-transform:uppercase}
    nav.menu a.link-btn{display:inline-flex;align-items:center;justify-content:center;min-width:110px;min-height:44px;height:40px;padding:0 12px;border-radius:10px;border:1px solid transparent;font-weight:900}
    nav.menu a.link-btn:hover{border-color:#2a3150;color:var(--ink)}
    .authwrap{display:flex;align-items:center;gap:6px;background:linear-gradient(180deg,#151b31,#12182c); border:1px solid #2a3150;border-radius:999px; padding:4px; box-shadow:0 6px 18px rgba(5,10,30,.35); max-height:44px;}
    .hello{display:flex;align-items:center;gap:6px;color:#cbd3ff;font-weight:800;padding:4px 8px;font-size:12px}
    .pill-btn{display:inline-flex;align-items:center;justify-content:center;min-width:100px;min-height:44px;height:34px;padding:0 14px;border-radius:12px;border:1px solid #0078d455;background:var(--cta); color:#0b1930; font-weight:900; cursor:pointer;transition:transform .08s, filter .12s; font-size:13px;text-transform:uppercase;}
    .pill-btn:hover{filter:brightness(1.05); transform:translateY(-1px)}

    /* HERO */
    .hero{padding:22px 0 8px}
    .hero .eyebrow{display:inline-flex;align-items:center;gap:8px;font-weight:900;color:#cfe1ff;background:rgba(0,120,212,.15); border:1px solid rgba(0,120,212,.45);border-radius:999px;padding:6px 10px}
    .hero h1{margin:10px 0 10px;font-size:clamp(1.7rem,3.8vw,2.6rem);line-height:1.2}
    .hero p{color:var(--muted);max-width:900px}

    .kpi-grid{display:grid;gap:12px;grid-template-columns:repeat(4, minmax(160px,1fr));margin:8px 0 12px}
    .kpi{background:var(--surface2);border:1px solid var(--stroke);border-radius:14px;padding:14px}
    .kpi b{display:block;font-size:.82rem;color:#9fb6ff;text-transform:uppercase;letter-spacing:.4px}
    .kpi .num{font-weight:900;font-size:1.12rem}

    /* Tabs */
    .tabbar{display:flex;gap:12px;margin-top:8px}
    .tab-btn{ display:inline-flex;align-items:center;gap:10px;justify-content:center; min-height:44px;padding:10px 16px;border-radius:12px;font-weight:900;cursor:pointer; border:1px solid #2a3150;background:transparent;color:#e8ecff; }
    .tab-btn.active{background:var(--cta);border-color:transparent;color:#0b1930;box-shadow:0 10px 22px rgba(0,120,212,.22)}

    /* Gu√≠a de estudio (base) */
    #studyGuide{display:none;margin-top:14px}
    #studyGuide.open{display:block}
    .muted{color:var(--muted)}
    .card{background:linear-gradient(180deg,#111937,#0f1633);border:1px solid var(--stroke);border-radius:14px;padding:14px;box-shadow:var(--shadow)}

    /* DOMINIOS & SIMULADOR */
    .wrap{max-width:1160px;margin:0 auto;padding:0 20px}
    .grid-sim{display:grid;grid-template-columns:1.35fr .85fr;gap:16px;margin-top:16px}
    @media(max-width:860px){.grid-sim{grid-template-columns:1fr}}
    .panel{background:var(--surface);border:1px solid var(--stroke);border-radius:12px;padding:16px;box-shadow:var(--shadow)}
    .domains-list{list-style:none;padding-left:0;margin:0;display:grid;gap:12px}
    .dom-item{display:flex;align-items:center;gap:12px;border:1px solid var(--stroke);background:var(--surface2);border-radius:14px;padding:14px 16px;cursor:pointer}
    .dom-item:hover{border-color:#3a4883}
    .dom-item.active{outline:3px solid rgba(108,139,255,.28)}
    .dom-code{width:36px;height:36px;min-width:36px;display:grid;place-items:center;border-radius:999px;background:#0078d4;color:#fff;font-weight:900;letter-spacing:.2px;box-shadow:0 6px 14px rgba(0,120,212,.28)}
    .chip-dom{display:inline-flex;align-items:center;gap:8px;background:#0f1630;border:1px solid #313c6e;border-radius:999px;padding:6px 10px;font-weight:900;cursor:pointer}
    .chip-dom .led{width:10px;height:10px;border-radius:999px;background:transparent;border:2px solid #5c6bb2}
    .chip-dom.on{background:rgba(108,139,255,.14); border-color:#4a5cc3; box-shadow:0 0 0 2px rgba(108,139,255,.28) inset;}
    .chip-dom.on .led{background:#6c8bff; border-color:#6c8bff}
    .segmented{display:flex;gap:8px;background:var(--surface2);border:1px solid var(--stroke);border-radius:10px;padding:6px}
    .segmented input{display:none}
    .segmented label{flex:1;text-align:center;padding:8px 10px;border-radius:8px;cursor:pointer;font-weight:800}
    .segmented input:checked + label{background:#0f1630;border:1px solid #4c66c9}
    #startBtn{background:#0078d4;color:#0b0f22;border-color:transparent;box-shadow:0 10px 24px rgba(0,120,212,.35)}
    #startBtn.locked{ background:linear-gradient(180deg,#6fa4ff,#355ff6); color:#fff; border:1px solid rgba(71,103,220,.6); box-shadow:0 12px 26px rgba(53,95,246,.35); }
    #startBtn.locked .lock{ display:inline-grid;place-items:center;width:18px;height:18px;margin-right:8px;border-radius:5px;background:linear-gradient(180deg,#ffd699,#ff9900);color:#111;font-weight:900;box-shadow:0 0 0 3px rgba(255,153,0,.18);font-size:12px; }

    #infoDom{margin-top:16px;background:linear-gradient(180deg,#111937,#0f1633);border:1px solid var(--stroke);border-radius:14px;padding:18px;box-shadow:var(--shadow);display:none}
    .info-empty{color:var(--muted);border:1px dashed var(--stroke);padding:12px;border-radius:10px;background:#0f1630}

    /* Modal resultados (NUEVA) */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;z-index:120;padding:16px}
    .modal.show{display:flex}
    .modal-card{width:min(860px,100%);background:var(--surface);border:1px solid var(--stroke);border-radius:14px;padding:18px;box-shadow:var(--shadow)}
    .res-head{display:flex;align-items:center;gap:12px;margin-bottom:12px}
    .res-badge{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;font-weight:900}
    .res-pass{background:linear-gradient(180deg,#3ad97a,#1fb764);color:#0a1e14;box-shadow:0 0 0 4px rgba(58,217,122,.18)}
    .res-fail{background:linear-gradient(180deg,#ff8a8a,#ff5f5f);color:#290a0a;box-shadow:0 0 0 4px rgba(255,95,95,.18)}
    .metric-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin:10px 0 4px}
    @media(max-width:640px){ .metric-grid{grid-template-columns:repeat(2,1fr)} }
    .metric{background:var(--surface2);border:1px solid var(--stroke);border-radius:12px;padding:10px}
    .metric b{display:block;font-size:.75rem;color:#9fb6ff;letter-spacing:.25px}
    .metric .big{font-weight:900;font-size:1.4rem}
    .res-table{width:100%;border-collapse:separate;border-spacing:0 8px;margin-top:8px}
    .res-table th{font-size:.82rem;color:#9fb6ff;text-align:left;padding:0 8px}
    .res-row{background:var(--surface2);border:1px solid var(--stroke);border-radius:10px;overflow:hidden}
    .res-row td{padding:10px 8px;vertical-align:middle}
    .bar{height:10px;border-radius:999px;background:#0b1225;border:1px solid var(--stroke);overflow:hidden}
    .bar>span{display:block;height:100%}
    .bar-ok{background:#3ad97a}
    .bar-warn{background:#ffd66b}
    .bar-bad{background:#ff6b6b}
    .res-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
    .btn-ghost{background:transparent;border:1px solid #2a3150;color:#e8ecff;border-radius:10px;min-height:40px;padding:0 12px;font-weight:900;cursor:pointer}
    .btn-ghost:hover{border-color:#3c4a7e}
    .btn-primary{background:var(--cta);border:1px solid #2a3150;color:#0b1930;border-radius:10px;min-height:40px;padding:0 12px;font-weight:900;cursor:pointer}
    .diag-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    @media(max-width:640px){.diag-grid{grid-template-columns:1fr}}
    /* FOOTER */
    footer{border-top:1px solid var(--stroke);padding:24px 0;color:#9ca8d9;background:linear-gradient(180deg,rgba(22,27,45,.6),rgba(22,27,45,.2));margin-top:22px}
    .f-grid{display:grid;gap:14px;align-items:flex-start}
    @media(min-width:720px){.f-grid{grid-template-columns:1.2fr .8fr .8fr .8fr}}
    footer a{color:#cfe1ff} footer a:hover{text-decoration:underline}
    .footer-spacer{height:1px}
    /* Simulador (AZ-104 style) + tips */
    #simCard{
      position:relative;
      background:
        radial-gradient(95% 140% at 100% 0, rgba(0,120,212,.18), transparent 60%),
        linear-gradient(180deg,#111937,#0f1633);
      border:1px solid rgba(0,120,212,.45);
      box-shadow:0 0 0 1px rgba(55,149,229,.25) inset, 0 22px 40px rgba(0,0,0,.55);
    }
    #simCard::after{ content:""; position:absolute; inset:-6px; border-radius:16px; pointer-events:none; box-shadow:0 0 0 3px rgba(0,120,212,.25); }
    #simTitle{ font-size:clamp(1.4rem,3.0vw,2.0rem); font-weight:900; line-height:1.2; letter-spacing:.2px; text-shadow:0 10px 28px rgba(0,120,212,.35); margin-bottom:6px; }
    #simCard .segmented{ background:rgba(255,255,255,.04); border:1px solid #2a3b6d; padding:6px; }
    #simCard .segmented input:checked + label{ background:linear-gradient(180deg,#164d86,#0e3570); border:1px solid rgba(0,120,212,.55); box-shadow:0 0 0 2px rgba(0,120,212,.30) inset; }
    #simCard select{ background:#0f1b3a;color:var(--ink); border:1px solid #2a3b6d;border-radius:10px; padding:10px 12px;font-weight:800;min-width:84px; }
    #simCard .chip-dom{ padding:10px 14px;border-radius:999px; border-color:#2a3b6d;background:transparent;color:#d6e5ff; box-shadow:0 2px 0 rgba(0,0,0,.12); }
    #simCard .chip-dom.on{ background:rgba(0,120,212,.08); border-color:#3a62b3; box-shadow:0 0 0 2px rgba(0,120,212,.22) inset; }
    #simCard .chip-dom .led{width:14px;height:14px;border:2px solid #6a78b4}
    #simCard .chip-dom.on .led{background:#0078d4;border-color:#0078d4}
    #tips305 .pill{ display:inline-flex; align-items:center; gap:8px; font-size:.86rem; font-weight:900; letter-spacing:.2px; background:rgba(0,120,212,.16); border:1px solid rgba(0,120,212,.45); color:#d7e8ff; padding:6px 10px; border-radius:999px; margin:0 0 8px; }
    #tips305 h2{ margin:10px 0 6px; text-transform:uppercase }
    #tips305 .lead{ color:var(--muted); margin:0 0 14px }
    #tips305 .search{ display:flex; align-items:center; gap:10px; margin:8px 0 18px; background:linear-gradient(180deg,#0f1a35,#0c152b); border:1px solid var(--stroke); border-radius:12px; padding:10px 12px; box-shadow:var(--shadow); }
    #tips305 .search input{ all:unset; flex:1; color:var(--ink); font-weight:700; letter-spacing:.2px; padding:6px 2px; }
    #tips305 .grid{ display:grid; gap:12px; grid-template-columns:repeat(4, minmax(180px, 1fr)); }
    @media (max-width:1024px){ #tips305 .grid{ grid-template-columns:repeat(3, 1fr);} }
    @media (max-width:760px){  #tips305 .grid{ grid-template-columns:repeat(2, 1fr);} }
    @media (max-width:520px){  #tips305 .grid{ grid-template-columns:1fr;} }
    #tips305 .tile{ background:linear-gradient(180deg,#122046,#0f1c3b); border:1px solid var(--stroke); border-radius:14px; padding:14px; box-shadow:var(--shadow); display:flex; flex-direction:column; gap:10px; min-height:160px; transition:transform .12s ease, border-color .12s ease, background .12s ease; }
    #tips305 .tile:hover{ transform:translateY(-2px); background:linear-gradient(180deg,#152650,#112042); border-color:#2f3c6e; }
    #tips305 .tile h3{ margin:0; font-size:1.02rem; line-height:1.25; display:flex; align-items:center; gap:8px; }
    #tips305 .dot{ width:12px;height:12px;border-radius:999px;background:linear-gradient(180deg,#7bd3ff,#1ea0ff); box-shadow:0 0 0 4px rgba(0,120,212,.18); flex:0 0 12px; }
    #tips305 .tile p{ margin:0; color:var(--muted) }
    #tips305 .btn{ margin-top:auto; align-self:flex-start; display:inline-flex; align-items:center; gap:6px; min-height:34px; padding:0 12px; border-radius:10px; border:1px solid #3b2fff44; background:linear-gradient(180deg,#6c8bff,#3e64ff); color:#fff; font-weight:900; text-decoration:none; filter:saturate(1); transition:filter .12s ease, transform .08s ease; }
    #tips305 .btn:hover{ filter:brightness(1.06); transform:translateY(-1px) }
    .hidden{ display:none !important; }
  </style>
</head>
<body>
  <header role="banner">
    <div class="container nav">
      <div class="brand">
        <img class="site-logo" src="/assets/ithub-logo.svg" alt="ITHub: inicio">
      </div>
      <nav class="menu" aria-label="Navegaci√≥n principal">
        <a class="link-btn" href="/">HOME</a>
        <a class="link-btn" href="/content/content.html">CONTENIDOS</a>
        <a class="link-btn" href="/score/ranking.html">RANKING</a>
      </nav>
      <div class="authwrap" id="authWrap" aria-label="Acciones de sesi√≥n">
        <a id="btnLogin"  class="pill-btn" href="/login/login.html" role="button">LOGIN</a>
        <a id="btnSignup" class="pill-btn" href="/login/login.html#signup" role="button">REG√çSTRATE</a>
        <div id="userArea" style="display:none;align-items:center;gap:6px">
          <div class="hello">üëã <span id="userNameTop" style="font-weight:900">USER</span></div>
          <a class="pill-btn" href="/user/profile.html" role="button" style="background:linear-gradient(180deg,#ffcf6a,#ff9900);color:#111">PERFIL</a>
          <button id="btnLogout" class="pill-btn" type="button" style="background:linear-gradient(180deg,#ffcf6a,#ff9900);color:#111">LOGOUT</button>
        </div>
      </div>
    </div>
  </header>

  <main id="main">
    <!-- HERO -->
    <section class="hero">
      <div class="container">
        <span class="eyebrow">AZURE SOLUTIONS ARCHITECT ‚Äî EXPERT (AZ-305)</span>
        <h1>Portada de la certificaci√≥n AZ-305</h1>
        <p>Dise√±a soluciones de infraestructura en Azure: identidad y gobierno, almacenamiento de datos, continuidad de negocio e infraestructura. Aqu√≠ tienes <b>Tips de Estudio</b> y <b>Dominios & Simulador</b> en pesta√±as.</p>

        <!-- Botonera de pesta√±as -->
        <div class="tabbar" role="tablist" aria-label="Vistas de AZ-305">
          <button id="tabSim" class="tab-btn active" role="tab" aria-selected="true" aria-controls="domsim">üß≠ DOMINIOS & SIMULADOR</button>
          <button id="tabGuide" class="tab-btn" role="tab" aria-selected="false" aria-controls="studyGuide">üìò TIPS DE ESTUDIO</button>
        </div>

        <!-- ===== GU√çA DE ESTUDIO (incrustada) ===== -->
        <section id="studyGuide" aria-label="Gu√≠a de estudio AZ-305" role="tabpanel" aria-labelledby="tabGuide">
          <div id="tips305" class="container" style="padding:0">
            <div class="pill">TIPS DE ESTUDIO ¬∑ AZ-305</div>
            <h2 style="margin:6px 0 8px">Explora conceptos clave y abre los art√≠culos al instante</h2>
            <p class="lead">Pasa el rat√≥n para ver el tip y usa el buscador para filtrar. Cada tarjeta abre un art√≠culo de referencia del dominio AZ-305.</p>

            <label class="search" aria-label="Buscar conceptos">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M21 21l-4.2-4.2M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15z"
                      stroke="#9fb2ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <input id="tipsSearch" type="search" placeholder="Buscar (ej: RBAC, Storage, VPN, DR, Zero Trust)">
            </label>

            <section id="tipsGrid" class="grid" aria-label="Lista de tips">
              <article class="tile" data-tags="zero trust security identidad governance policy defender identity rbac">
                <h3><span class="dot" aria-hidden="true"></span> Zero Trust y gobierno</h3>
                <p>Principios Zero Trust, segmentaci√≥n, hardening de identidad, Policy vs RBAC y controles en capas.</p>
                <a class="btn" href="/content/azure-security-zero-trust-az305.html">Leer ‚Üí</a>
              </article>

              <article class="tile" data-tags="cost reliability fiabilidad costos resiliencia zonas zrs gzs ha">
                <h3><span class="dot" aria-hidden="true"></span> Cost & Reliability</h3>
                <p>Patrones de resiliencia (ZRS/GZRS, zonas, colas), trade-offs de coste, pruebas de caos y SLOs.</p>
                <a class="btn" href="/content/azure-cost-reliability-az305.html">Leer ‚Üí</a>
              </article>

              <article class="tile" data-tags="data datos elecciones sql cosmos lakehouse particionado consistencia cap">
                <h3><span class="dot" aria-hidden="true"></span> Data choices</h3>
                <p>Elecci√≥n entre SQL/Cosmos/Storage, partici√≥n y consistencia, costos, disponibilidad y seguridad.</p>
                <a class="btn" href="/content/azure-data-choices-az305.html">Leer ‚Üí</a>
              </article>

              <article class="tile" data-tags="ha dr continuidad negocio backup recovery rpo rto asr grs gzrs runbooks">
                <h3><span class="dot" aria-hidden="true"></span> HA & DR</h3>
                <p>Modelos Activo/Activo vs Activo/Pasivo, RPO/RTO, ASR, GRS/GZRS, pruebas y runbooks.</p>
                <a class="btn" href="/content/azure-ha-dr-az305.html">Leer ‚Üí</a>
              </article>

              <article class="tile" data-tags="red network hybrid connectivity vpn expressroute dns privado hub spoke bgp">
                <h3><span class="dot" aria-hidden="true"></span> Conectividad h√≠brida</h3>
                <p>VPN/ER, patrones hub-spoke, BGP, DNS privado, SNAT/UDR y l√≠mites de flujo.</p>
                <a class="btn" href="/content/azure-hybrid-connectivity-az305.html">Leer ‚Üí</a>
              </article>

              <article class="tile" data-tags="network arquitectura vnet nsg waf firewall balanceador appgw peering rutas">
                <h3><span class="dot" aria-hidden="true"></span> Arquitectura de red</h3>
                <p>Dise√±o de VNet, NSG/ASG, WAF/Firewall, balanceo L4/L7, peering y rutas.</p>
                <a class="btn" href="/content/azure-network-architecture-az305.html">Leer ‚Üí</a>
              </article>
            </section>
          </div>
        </section>
      </div>
    </section>

    <!-- ===== DOMINIOS & SIMULADOR ===== -->
    <section id="domsim" role="tabpanel" aria-labelledby="tabSim">
      <div class="wrap">
        <div class="grid-sim">
          <!-- IZQUIERDA: dominios -->
          <section class="panel" id="leftInfo">
            <div style="display:flex;gap:16px;align-items:flex-start;flex-wrap:wrap">
              <img id="provLogo" alt="Azure" style="width:66px;height:auto">
              <div id="provText" style="color:var(--muted)">Dominios oficiales y notas r√°pidas por tema.</div>
            </div>

            <h2 style="margin-top:14px">Dominios del examen</h2>
            <p class="muted" style="margin-top:-6px"><em>Haz clic en un dominio para abrir notas √∫tiles abajo.</em></p>

            <ul id="domainsList" class="domains-list"></ul>
          </section>

          <!-- DERECHA: simulador -->
          <aside class="panel" id="simCard" aria-label="Simulador AZ-305">
            <h3 id="simTitle">AZ-305 ¬∑ Simulador de examen</h3>

            <div class="field">
              <label>Modo</label>
              <div class="segmented" id="modeSeg">
                <input type="radio" id="modePractice" name="mode" value="practice" checked>
                <label for="modePractice">Pr√°ctica</label>
                <input type="radio" id="modeExam" name="mode" value="exam" disabled>
                <label for="modeExam" class="disabled" title="Modo examen pr√≥ximamente">Examen</label>
              </div>
            </div>

            <div class="field" style="margin-top:10px">
             <label>Preguntas</label>
             <select id="qCount" style="border:1px solid var(--stroke);border-radius:10px;padding:8px 10px;background:var(--surface2);color:var(--ink)">
              <option>5</option><option>10</option><option>15</option><option>30</option><option>65</option>
            </select>
            </div>

            <div class="field" style="margin-top:10px">
              <label>Dominios (filtro opcional)</label>
              <div id="domainChips" style="display:flex;flex-wrap:wrap;gap:8px"></div>
              <div style="color:var(--muted)">D√©jalo vac√≠o para incluir todos los dominios.</div>
            </div>

            <div class="field" style="margin-top:12px">
              <button id="startBtn" class="pill-btn" type="button">‚ñ∂ Empezar</button>
            </div>
          </aside>
        </div>

        <!-- Notas del dominio -->
        <section id="infoDom" class="panel" aria-live="polite">
          <div style="display:flex;align-items:center;justify-content:space-between;margin:0 0 10px">
            <h3 id="infoTitle" style="margin:0">Notas del dominio</h3>
            <button id="infoClose" class="pill-btn" type="button">‚úñ Cerrar</button>
          </div>
          <div id="infoContent" class="info-content">
            <div class="info-empty">Selecciona un dominio para ver notas concisas aqu√≠.</div>
          </div>
        </section>

        <!-- √Årea de preguntas -->
        <main id="view" class="wrap" style="padding:0"></main>
      </div>
    </section>
  </main>

  <!-- Pie -->
  <footer role="contentinfo">
    <div class="container f-grid">
      <div>
        <div class="brand" style="text-transform:none;display:flex;align-items:center;gap:10px;">
          <span class="logo-pill" aria-hidden="true" style="width:18px;height:34px;border-radius:10px;background:linear-gradient(180deg,#8fd0ff 0%,#0078d4 100%);box-shadow:0 0 0 6px rgba(0,120,212,.18)"></span>
          <span style="font-weight:900">ITHub.es</span>
        </div>
        <p style="margin:8px 0 0;max-width:520px">Aprende, practica y aprueba tus certificaciones mientras compites con el resto del mundo.</p>
      </div>
      <div>
        <div style="font-weight:800">Simuladores</div>
        <div><a href="/certification/microsoft-azure/az-104/lz-azure-az-104.html">AZ-104</a></div>
        <div><a href="/certification/amazon aws/aws-saa-c03/lz-aws-saa-c03.html">SAA-C03</a></div>
        <div><a href="/certification/microsoft-azure/az-305/lz-azure-az-305.html">AZ-305</a></div>
      </div>
      <div>
        <div style="font-weight:800">Contenidos</div>
        <div><a href="/content/azure-landing-zone.html">Azure ¬∑ Landing Zone</a></div>
        <div><a href="/content/azure-hybrid-connectivity-az305.html">Azure ¬∑ Conectividad h√≠brida</a></div>
        <div><a href="/content/azure-bcdr-az305.html">Azure ¬∑ Continuidad de negocio</a></div>
      </div>
      <div>
        <div style="font-weight:800">Contacto</div>
        <button id="footerContactBtn" type="button" style="background:none;border:none;color:#cfe1ff;font-weight:800;display:inline-flex;align-items:center;gap:6px;cursor:pointer;padding:0;margin-top:6px;">üí¨ <span>Cont√°ctanos</span></button>
      </div>
    </div>
    <div class="container" style="margin-top:12px;font-size:12px;display:flex;justify-content:space-between;gap:10px;align-items:center;">
      <span>¬© <span id="y"></span> ITHub.es</span>
      <span class="footer-spacer"></span>
    </div>
  </footer>

  <!-- Modal resultados (NUEVA) -->
  <div class="modal" id="quizResultModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="resTitle">
    <div class="modal-card">
      <div class="res-head">
        <h3 id="resTitle" style="margin:0;font-size:1.2rem">üìä Resultados del simulador</h3>
        <span id="resBadge" class="res-badge res-pass" style="display:none">APTO</span>
        <span id="resBadgeFail" class="res-badge res-fail" style="display:none">NO APTO</span>
      </div>

      <div id="resMetrics" class="metric-grid" aria-label="Resumen"></div>

      <div style="margin-top:6px">
        <table class="res-table" aria-label="Desglose por dominio">
          <thead>
            <tr>
              <th>Dominio</th>
              <th style="width:40%">Progreso</th>
              <th>Aciertos</th>
              <th>Fallos</th>
              <th>Total</th>
              <th>%</th>
            </tr>
          </thead>
          <tbody id="resBody"></tbody>
        </table>
      </div>

      <div class="res-actions">
        <button id="resReview" class="btn-ghost" type="button">Revisar respuestas</button>
        <button id="resRetry" class="btn-ghost" type="button">Reintentar</button>
        <button id="qrClose" class="btn-primary" type="button">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Motor del simulador -->
  <script src="/control_quizs/Q_global_dark.js" defer></script>

  <script>
    // A√±o
    document.getElementById('y').textContent = new Date().getFullYear();

    /* ===== AUTH helpers ===== */
    function getCurrentUser(){ try{ return JSON.parse(localStorage.getItem("currentUser")||"null"); }catch{ return null; } }
    function isLoggedIn(){ return !!getCurrentUser(); }

    /* ===== AUTH header ===== */
    function renderHeaderAuth(){
      const u=getCurrentUser();
      const login=document.getElementById('btnLogin');
      const signup=document.getElementById('btnSignup');
      const userArea=document.getElementById('userArea');
      const nameTop=document.getElementById('userNameTop');
      if(u){ login.style.display='none'; signup.style.display='none'; userArea.style.display='flex'; nameTop.textContent=(u.name||u.email||'USER').toUpperCase(); }
      else{ login.style.display='inline-flex'; signup.style.display='inline-flex'; userArea.style.display='none'; }
    }
    document.getElementById('btnLogout')?.addEventListener('click', ()=>{
      localStorage.removeItem('currentUser');
      renderHeaderAuth();
      renderStartButton();
    });
    renderHeaderAuth();

    /* ===== Tabs ===== */
    const tabSim   = document.getElementById('tabSim');
    const tabGuide = document.getElementById('tabGuide');
    const secSim   = document.getElementById('domsim');
    const secGuide = document.getElementById('studyGuide');

    function activate(tab){
      const isGuide = (tab === 'guide');
      tabGuide.classList.toggle('active', isGuide);
      tabGuide.setAttribute('aria-selected', isGuide ? 'true' : 'false');
      tabSim.classList.toggle('active', !isGuide);
      tabSim.setAttribute('aria-selected', !isGuide ? 'true' : 'false');
      secGuide.classList.toggle('open', isGuide);
      secGuide.style.display = isGuide ? 'block' : 'none';
      secSim.style.display    = isGuide ? 'none'  : 'block';
      (isGuide ? secGuide : secSim).scrollIntoView({behavior:'smooth', block:'start'});
    }
    tabGuide.addEventListener('click', ()=>activate('guide'));
    tabSim  .addEventListener('click', ()=>activate('sim'));

    /* ===== Tips Grid (buscador) ===== */
    (function(){
      const q = document.getElementById('tipsSearch');
      if(!q) return;
      const cards = Array.from(document.querySelectorAll('#tipsGrid .tile'));
      function norm(s){ return (s||'').toLowerCase().normalize('NFD').replace(/\p{Diacritic}/gu,''); }
      function apply(){
        const t = norm(q.value);
        if(!t){ cards.forEach(c=>c.classList.remove('hidden')); return; }
        cards.forEach(c=>{
          const hay = norm(c.textContent) + ' ' + norm(c.dataset.tags||'');
          c.classList.toggle('hidden', !hay.includes(t));
        });
      }
      q.addEventListener('input', apply);
    })();

    /* ===== DOMINIOS & SIMULADOR ===== */
    const QUIZ = 'az-305';
    const CONFIG = {
      'az-305': {
        logo: 'https://upload.wikimedia.org/wikipedia/commons/a/a8/Microsoft_Azure_Logo.svg',
        blurb: 'Dominios oficiales de AZ-305 con notas r√°pidas para el examen.',
        domains: [
          ['D1','Dise√±ar soluciones de identidad, gobierno y monitorizaci√≥n (25‚Äì30%)'],
          ['D2','Dise√±ar soluciones de almacenamiento de datos (20‚Äì25%)'],
          ['D3','Dise√±ar soluciones de continuidad de negocio (15‚Äì20%)'],
          ['D4','Dise√±ar soluciones de infraestructura (30‚Äì35%)']
        ]
      }
    };
    const DOMAIN_FILES = {
      'az-305': {
        D1:'/tips/azure-az305-tips-domain1.html',
        D2:'/tips/azure-az305-tips-domain2.html',
        D3:'/tips/azure-az305-tips-domain3.html',
        D4:'/tips/azure-az305-tips-domain4.html'
      }
    };

    const badgeLogo=document.getElementById('provLogo'),
          provText=document.getElementById('provText'),
          dlist=document.getElementById('domainsList'),
          chips=document.getElementById('domainChips'),
          startBtn=document.getElementById('startBtn'),
          qCount=document.getElementById('qCount'),
          infoDom=document.getElementById('infoDom'),
          infoTitle=document.getElementById('infoTitle'),
          infoContent=document.getElementById('infoContent'),
          view=document.getElementById('view');

    const cfg = CONFIG[QUIZ];
    badgeLogo.src = cfg.logo; badgeLogo.alt = 'Azure';
    provText.textContent = cfg.blurb;

    dlist.innerHTML = cfg.domains.map(([d,txt]) =>
      `<li class="dom-item" data-dn="${d}">
         <span class="dom-code">${d}</span>
         <span class="dom-title">${txt}</span>
       </li>`).join('');
    chips.innerHTML = cfg.domains.map(([d]) =>
      `<label class="chip-dom" data-dn="${d}">
         <input type="checkbox" value="${d}" hidden>
         <span class="led"></span> ${d}
       </label>`).join('');
    function updateChipVisuals(){
      chips.querySelectorAll('.chip-dom').forEach(lbl=>{
        const cb = lbl.querySelector('input[type="checkbox"]');
        lbl.classList.toggle('on', !!cb.checked);
      });
    }
    chips.addEventListener('click', (ev)=>{
      const wrap = ev.target.closest('.chip-dom'); if(!wrap) return;
      const cb = wrap.querySelector('input[type="checkbox"]'); cb.checked = !cb.checked; updateChipVisuals();
    });
    updateChipVisuals();

    dlist.addEventListener('click', (ev)=>{
      const li = ev.target.closest('.dom-item'); if(!li) return;
      dlist.querySelectorAll('.dom-item').forEach(x=>x.classList.remove('active'));
      li.classList.add('active');
      loadDomainNotes(li.dataset.dn);
    });

    async function loadDomainNotes(domainCode){
      const map = DOMAIN_FILES[QUIZ]||{};
      const file = map[domainCode];
      infoTitle.textContent = `${domainCode} ‚Äî Notas`;
      infoDom.style.display = 'block';
      infoContent.innerHTML = `<div class="info-empty">Cargando notas‚Ä¶</div>`;
      if(!file){ infoContent.innerHTML = `<div class="info-empty">No hay archivo de notas asignado para <b>${domainCode}</b>.</div>`; return; }
      try{
        const res = await fetch(file, {cache:'no-store'});
        const html = await res.text();
        const doc = new DOMParser().parseFromString(html, 'text/html');
        doc.querySelectorAll('script,link').forEach(n=>n.remove());
        const src = doc.querySelector('.wrap') || doc.body;
        infoContent.innerHTML = src ? src.innerHTML : html;
        infoDom.scrollIntoView({behavior:'smooth', block:'start'});
      }catch(e){
        infoContent.innerHTML = `<div class="info-empty">No se pudieron cargar las notas de <b>${domainCode}</b>.</div>`;
      }
    }
    document.getElementById('infoClose').addEventListener('click', ()=>{ infoDom.style.display='none'; });

    /* ===== Bot√≥n START seg√∫n sesi√≥n ===== */
    function renderStartButton(){
      if (!startBtn) return;
      if (isLoggedIn()){
        startBtn.classList.remove('locked');
        startBtn.dataset.locked = "false";
        startBtn.innerHTML = '‚ñ∂ Empezar';
      }else{
        startBtn.classList.add('locked');
        startBtn.dataset.locked = "true";
        startBtn.innerHTML = '<span class="lock">üîí</span>Login to Start';
      }
      startBtn.disabled = false;
    }
    renderStartButton();

    // Simulador
    let quizActive = false;
    const header = document.querySelector('header');

    function smoothScrollTo(el){
      if(!el) return;
      const rect = el.getBoundingClientRect();
      const offset = (header?header.offsetHeight:0)+10;
      const top = rect.top + window.scrollY - offset;
      window.scrollTo({ top, behavior:'smooth' });
    }

    function setQuizActive(on){
      quizActive = !!on;
      if (quizActive){
        startBtn.textContent = '‚è≥ En marcha‚Ä¶';
      }else{
        renderStartButton();
      }
      startBtn.setAttribute('aria-disabled', quizActive ? 'true' : 'false');
    }

    function waitForQuizMount(timeout=4000){
      return new Promise(resolve=>{
        if (view.children.length>0) return resolve();
        const obs = new MutationObserver(()=>{ if(view.children.length>0){ obs.disconnect(); resolve(); }});
        obs.observe(view,{childList:true});
        setTimeout(()=>{ obs.disconnect(); resolve(); }, timeout);
      });
    }

    function engineReady(){ return typeof window.start === 'function'; }
    function waitForEngine(timeout=5000){
      return new Promise(resolve=>{
        if (engineReady()) return resolve(true);
        const start = performance.now();
        const id = setInterval(()=>{
          if (engineReady() || performance.now()-start>timeout){ clearInterval(id); resolve(engineReady()); }
        }, 50);
      });
    }

    window.addEventListener('quiz:started', ()=>{ setQuizActive(true); smoothScrollTo(document.querySelector('#view .question-card')||view); });
    window.addEventListener('quiz:ended',   ()=>{ setQuizActive(false); });

    startBtn.addEventListener('click', async ()=>{
      if (startBtn.dataset.locked === "true"){ window.location.href = '/login/login.html'; return; }
      if (quizActive) return;
      if (infoDom.style.display !== 'none') { infoDom.style.display='none'; }

      // ignorar selecci√≥n de dominios => TODOS
      const count = parseInt(qCount.value,10) || 65;
      const tags = undefined;

      const ok = await waitForEngine(6000);
      if(!ok){ alert('Motor de simulador no cargado. Actualiza la p√°gina.'); return; }

      if(typeof window.start === 'function'){
        setQuizActive(true);
        try{
          window.start(QUIZ, { count, tags });
          await waitForQuizMount();
          smoothScrollTo(document.querySelector('#view .question-card')||view);
        }catch(e){
          setQuizActive(false);
          alert('No se pudo iniciar el simulador.');
        }
      }else{
        setQuizActive(false);
        alert('Motor de simulador no cargado.');
      }
    });

    /* ===== Nueva MODAL de resultados ===== */
    const qrModal = document.getElementById('quizResultModal');
    const qrClose = document.getElementById('qrClose');
    const resBody = document.getElementById('resBody');
    const resMetrics = document.getElementById('resMetrics');
    const resBadgePass = document.getElementById('resBadge');
    const resBadgeFail = document.getElementById('resBadgeFail');
    const btnRetry = document.getElementById('resRetry');
    const btnReview = document.getElementById('resReview');

    function pct(a,b){ return b ? Math.round((a/b)*100) : 0; }
    function barCls(p){ return p<50?'bar-bad':(p<75?'bar-warn':'bar-ok'); }

    function renderMetrics(data){
      // Agregados robustos
      const byDom = data?.byDomain || {};
      let tot = Number(data?.total || 0);
      let correct = Number(data?.correct || 0);

      // Si no vienen, intenta inferirlos
      if (!tot || !correct){
        let c=0,t=0;
        Object.values(byDom).forEach(d=>{ c += Number(d.correct||0); t += Number(d.total||0); });
        if(!tot) tot = t;
        if(!correct) correct = c;
      }
      const wrong = Math.max(0, tot - correct);
      const score = Number(data?.score ?? correct); // si el motor usa puntos=aciertos, esto cuadra
      const percent = pct(correct, tot);

      // Badge (umbral configurable)
      const PASS_THRESHOLD = 70;
      if(percent >= PASS_THRESHOLD){ resBadgePass.style.display='inline-flex'; resBadgeFail.style.display='none'; }
      else{ resBadgePass.style.display='none'; resBadgeFail.style.display='inline-flex'; }

      // M√©tricas
      resMetrics.innerHTML = `
        <div class="metric"><b>Puntuaci√≥n</b><div class="big">${score}</div></div>
        <div class="metric"><b>Aciertos</b><div class="big">${correct}</div></div>
        <div class="metric"><b>Fallos</b><div class="big">${wrong}</div></div>
        <div class="metric"><b>Precisi√≥n</b><div class="big">${percent}%</div></div>
      `;

      // Tabla por dominio
      resBody.innerHTML = '';
      if (byDom && Object.keys(byDom).length){
        Object.entries(byDom).forEach(([code,info])=>{
          const name = info?.name || code;
          const c = Number(info?.correct||0);
          const t = Number(info?.total||0);
          const w = Math.max(0, t - c);
          const p = pct(c,t);
          const tr = document.createElement('tr');
          tr.className = 'res-row';
          tr.innerHTML = `
            <td style="font-weight:800">${name}</td>
            <td>
              <div class="bar"><span class="${barCls(p)}" style="width:${p}%"></span></div>
            </td>
            <td style="font-weight:800;color:#a8f0c6">${c}</td>
            <td style="font-weight:800;color:#ffb3b3">${w}</td>
            <td>${t}</td>
            <td>${p}%</td>
          `;
          resBody.appendChild(tr);
        });
      }
    }

    function showResultsModal(payload){
      try{ renderMetrics(payload||{}); }catch(_){}
      qrModal.classList.add('show');
      qrModal.setAttribute('aria-hidden','false');
    }

    qrClose.addEventListener('click', ()=>{ qrModal.classList.remove('show'); qrModal.setAttribute('aria-hidden','true'); });
    qrModal.addEventListener('click', (e)=>{ if(e.target===qrModal){ qrModal.classList.remove('show'); qrModal.setAttribute('aria-hidden','true'); } });

    btnRetry.addEventListener('click', ()=>{ qrModal.classList.remove('show'); qrModal.setAttribute('aria-hidden','true'); window.scrollTo({top:0,behavior:'smooth'}); });
    btnReview.addEventListener('click', ()=>{
      if (typeof window.review === 'function'){ try{ window.review(); }catch{} }
      else { alert('Revisi√≥n no disponible en este modo.'); }
    });

    // Exponer para el motor
    window.quizResults = showResultsModal;
    window.addEventListener('quiz:results', (e)=> showResultsModal(e.detail||{}));
  </script>
</body>
</html>
