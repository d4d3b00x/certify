<!doctype html>
<html lang="es">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DYZ3GCXHEK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    gtag('js', new Date());
    gtag('config', 'G-DYZ3GCXHEK');
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0f1320" />

  <title>SAA-C03: Simulador y Gu√≠a de Estudio ‚Äî AWS Solutions Architect Associate | ITHub</title>
  <link rel="canonical" href="https://beta.ithub.es/certification/amazon-aws/saa-c03/lz-aws-saa-c03.html" />
  <meta name="description" content="Simulador SAA-C03 con preguntas por dominios (D1‚ÄìD4) y nube de conceptos. Practica AWS Solutions Architect Associate y supera 720/1000." />
  <meta name="keywords" content="SAA-C03, simulador SAA-C03, preguntas AWS en espa√±ol, AWS Solutions Architect Associate, gu√≠a de estudio SAA-C03, dominios" />

  <style>
    :root{
      --bg:#0f1320;--surface:#161b2d;--surface2:#1b2140;--ink:#e8ecff;--muted:#9ca8d9;
      --stroke:#283056;--aws:#ff9900;--radius:14px;--shadow:0 12px 28px rgba(6,12,40,.45);
      --cta:linear-gradient(180deg,#ffd699,#ff9900);
      --ok:#20d38a;--warn:#ffd76b;--bad:#ff6b6b;
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:Inter,ui-sans-serif,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      color:var(--ink);
      background:
        radial-gradient(900px 420px at 90% -10%,rgba(255,153,0,.15),transparent 60%),
        radial-gradient(800px 400px at 10% 0%,rgba(255,153,0,.10),transparent 60%),
        var(--bg);
      line-height:1.6;overflow-x:hidden;
    }
    a{color:inherit;text-decoration:none}
    .container{max-width:1160px;margin:0 auto;padding:0 20px}

    /* HEADER */
    header{position:sticky;top:0;z-index:50;backdrop-filter:blur(10px);
      background:linear-gradient(180deg,rgba(15,19,32,.85),rgba(15,19,32,.55));border-bottom:1px solid var(--stroke)}
    .nav{height:64px;display:flex;align-items:center;justify-content:space-between;gap:10px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:900;text-transform:uppercase}
    .brand img.site-logo{height:42px;width:auto;display:block}
    nav.menu{display:flex;gap:16px;color:var(--muted);font-weight:800;align-items:center;text-transform:uppercase}
    nav.menu a.link-btn{display:inline-flex;align-items:center;justify-content:center;min-width:110px;min-height:44px;height:40px;padding:0 12px;border-radius:10px;border:1px solid transparent;font-weight:900}
    nav.menu a.link-btn:hover{border-color:#2a3150;color:var(--ink)}
    .authwrap{display:flex;align-items:center;gap:6px;background:linear-gradient(180deg,#151b31,#12182c); border:1px solid #2a3150;border-radius:999px; padding:4px; box-shadow:0 6px 18px rgba(5,10,30,.35); max-height:44px;}
    .hello{display:flex;align-items:center;gap:6px;color:#cbd3ff;font-weight:800;padding:4px 8px;font-size:12px}
    .pill-btn{display:inline-flex;align-items:center;justify-content:center;min-width:100px;min-height:44px;height:34px;padding:0 14px;border-radius:12px;border:1px solid #ff990044;background:var(--cta); color:#0b1930; font-weight:900; cursor:pointer;transition:transform .08s, filter .12s; font-size:13px;text-transform:uppercase;}
    .pill-btn:hover{filter:brightness(1.05); transform:translateY(-1px)}

    /* HERO */
    .hero{padding:22px 0 8px}
    .hero .eyebrow{display:inline-flex;align-items:center;gap:8px;font-weight:900;color:#fff2e0;background:rgba(255,153,0,.18);
      border:1px solid rgba(255,153,0,.45);border-radius:999px;padding:6px 10px}
    .hero h1{margin:10px 0 10px;font-size:clamp(1.7rem,3.8vw,2.6rem);line-height:1.2}
    .hero p{color:var(--muted);max-width:900px}

    .kpi-grid{display:grid;gap:12px;grid-template-columns:repeat(4, minmax(160px,1fr));margin:8px 0 12px}
    .kpi{background:var(--surface2);border:1px solid var(--stroke);border-radius:14px;padding:14px}
    .kpi b{display:block;font-size:.82rem;color:#ffc680;text-transform:uppercase;letter-spacing:.4px}
    .kpi .num{font-weight:900;font-size:1.12rem}

    /* Tabs */
    .tabbar{display:flex;gap:12px;margin-top:8px;flex-wrap:wrap}
    .tab-btn{display:inline-flex;align-items:center;gap:10px;justify-content:center;min-height:44px;padding:10px 16px;border-radius:12px;font-weight:900;cursor:pointer;border:1px solid #2a3150;background:transparent;color:#e8ecff}
    .tab-btn.active{background:var(--cta);border-color:transparent;color:#0b1930;box-shadow:0 10px 22px rgba(255,153,0,.22)}

    /* Gu√≠a de estudio */
    #studyGuide{display:none;margin-top:14px}
    #studyGuide.open{display:block}
    .muted{color:var(--muted)}
    .card{background:linear-gradient(180deg,#111937,#0f1633);border:1px solid var(--stroke);border-radius:14px;padding:14px;box-shadow:var(--shadow)}

    /* ====== DOMINIOS & SIMULADOR ====== */
    .wrap{max-width:1160px;margin:0 auto;padding:0 20px}
    .grid-sim{display:grid;grid-template-columns:1.35fr .85fr;gap:16px;margin-top:16px}
    @media(max-width:860px){.grid-sim{grid-template-columns:1fr}}
    .panel{background:var(--surface);border:1px solid var(--stroke);border-radius:12px;padding:16px;box-shadow:var(--shadow)}
    .domains-list{list-style:none;padding-left:0;margin:0;display:grid;gap:12px}
    .dom-item{display:flex;align-items:center;gap:12px;border:1px solid var(--stroke);background:var(--surface2);border-radius:14px;padding:14px 16px;cursor:pointer}
    .dom-item:hover{border-color:#3a4883}
    .dom-item.active{outline:3px solid rgba(255,176,102,.28)}
    .dom-code{width:36px;height:36px;min-width:36px;display:grid;place-items:center;border-radius:999px;background:#ff9900;color:#111;font-weight:900;letter-spacing:.2px;box-shadow:0 6px 14px rgba(255,153,0,.28)}
    .chip-dom{display:inline-flex;align-items:center;gap:8px;background:#0f1630;border:1px solid #313c6e;border-radius:999px;padding:6px 10px;font-weight:900;cursor:pointer}
    .chip-dom .led{width:10px;height:10px;border-radius:999px;background:transparent;border:2px solid #5c6bb2}
    .chip-dom.on{background:rgba(255,176,102,.14); border-color:#4a5cc3; box-shadow:0 0 0 2px rgba(255,176,102,.28) inset;}
    .chip-dom.on .led{background:#ffb066; border-color:#ffb066}
    .segmented{display:flex;gap:8px;background:var(--surface2);border:1px solid var(--stroke);border-radius:10px;padding:6px}
    .segmented input{display:none}
    .segmented label{flex:1;text-align:center;padding:8px 10px;border-radius:8px;cursor:pointer;font-weight:800}
    .segmented input:checked + label{background:#0f1630;border:1px solid #ffb066}
    #startBtn{background:#ff9900;color:#111;border-color:transparent;box-shadow:0 10px 24px rgba(255,153,0,.35)}

    /* ====== Notas dominio ====== */
    #infoDom{margin-top:16px;background:linear-gradient(180deg,#0f1736,#0e1430);border:1px solid var(--stroke);border-radius:16px;padding:0;box-shadow:0 20px 42px rgba(0,0,0,.45);display:none;overflow:hidden}
    .info-head{display:flex;gap:10px;align-items:center;justify-content:space-between;background:
      radial-gradient(120% 120% at 100% -10%, rgba(255,153,0,.25), transparent 60%),
      linear-gradient(180deg, #2b1a08, #1d1408);padding:16px;border-bottom:1px solid #5f4627}
    .info-head h3{margin:0;font-size:1.2rem;letter-spacing:.2px}
    .info-body{padding:16px}
    .meter{position:relative;height:10px;border-radius:999px;background:#0b1225;border:1px solid var(--stroke);overflow:hidden}
    .meter>span{position:absolute;left:0;top:0;height:100%;width:0;transition:width .35s}
    .m-ok{background:#3ad97a} .m-warn{background:#ffd66b} .m-bad{background:#ff6b6b}

    /* ===== Concept Cloud ===== */
    .concept-cloud{display:grid;grid-template-columns:repeat(6,1fr);gap:12px}
    @media(max-width:1180px){.concept-cloud{grid-template-columns:repeat(4,1fr)}}
    @media(max-width:860px){.concept-cloud{grid-template-columns:repeat(3,1fr)}}
    @media(max-width:560px){.concept-cloud{grid-template-columns:repeat(2,1fr)}}

    .chip-bubble{position:relative;display:flex;flex-direction:column;justify-content:center;gap:6px;min-height:96px;padding:14px;border-radius:18px;border:1px solid #5f4627;background:linear-gradient(180deg,#1b1426,#151022);box-shadow:0 12px 24px rgba(0,0,0,.25);transform:translateZ(0);transition:transform .12s ease, box-shadow .12s ease;overflow:hidden}
    .chip-bubble:hover{transform:scale(1.05);box-shadow:0 18px 38px rgba(0,0,0,.36)}
    .chip-bubble .cb-title{font-weight:900}
    .chip-bubble .cb-tip{color:var(--muted);opacity:.95;font-size:.95rem}
    .chip-bubble b{color:#ffd699}

    /* Footer */
    footer{border-top:1px solid var(--stroke);padding:24px 0;color:#9ca8d9;background:linear-gradient(180deg,rgba(22,27,45,.6),rgba(22,27,45,.2));margin-top:22px}
    .f-grid{display:grid;gap:14px}
    @media(min-width:720px){.f-grid{grid-template-columns:1.2fr .8fr .8fr .8fr}}
    footer a{color:#cfe1ff} footer a:hover{text-decoration:underline}
  </style>
</head>
<body>
  <header role="banner">
    <div class="container nav">
      <div class="brand">
        <img class="site-logo" src="/assets/ithub-logo.svg" alt="ITHub: inicio">
      </div>
      <nav class="menu" aria-label="Navegaci√≥n principal">
        <a class="link-btn" href="/">HOME</a>
        <a class="link-btn" href="/content/content.html">CONTENIDOS</a>
        <a class="link-btn" href="/score/ranking.html">RANKING</a>
      </nav>
      <div class="authwrap" id="authWrap" aria-label="Acciones de sesi√≥n">
        <a id="btnLogin"  class="pill-btn" href="/login/login.html" role="button">LOGIN</a>
        <a id="btnSignup" class="pill-btn" href="/login/login.html#signup" role="button">REG√çSTRATE</a>
        <div id="userArea" style="display:none;align-items:center;gap:6px">
          <div class="hello">üëã <span id="userNameTop" style="font-weight:900">USER</span></div>
          <a class="pill-btn" href="/user/profile.html" role="button" style="background:linear-gradient(180deg,#ffcf6a,#ff9900);color:#111">PERFIL</a>
          <button id="btnLogout" class="pill-btn" type="button" style="background:linear-gradient(180deg,#ffcf6a,#ff9900);color:#111">LOGOUT</button>
        </div>
      </div>
    </div>
  </header>

  <main id="main">
    <!-- HERO -->
    <section class="hero">
      <div class="container">
        <span class="eyebrow">AWS CERTIFIED SOLUTIONS ARCHITECT ‚Äî ASSOCIATE (SAA-C03)</span>
        <h1>Portada de la certificaci√≥n <span style="color:#ffcc80"><a href="/certification/amazon%20aws/index.html">AWS</a></span> /  SAA-C03</h1>
        <p>Dise√±a arquitecturas <b>seguras</b>, <b>resilientes</b>, de <b>alto rendimiento</b> y <b>optimizadas en coste</b> en AWS. Aqu√≠ tienes <b>Dominios & Simulador</b> y la nueva <b>Nube de Conceptos</b> con b√∫squeda instant√°nea.</p>

        <!-- Botonera de pesta√±as -->
        <div class="tabbar" role="tablist" aria-label="Vistas de SAA-C03">
          <button id="tabSim" class="tab-btn active" role="tab" aria-selected="true" aria-controls="domsim">üß≠ DOMINIOS & SIMULADOR</button>
          <button id="tabGuide" class="tab-btn" role="tab" aria-selected="false" aria-controls="studyGuide">üìò CONCEPTOS A EXAMEN</button>
          <!-- NUEVO BOT√ìN -->
          <a class="tab-btn" id="tabStudyExternal" href="/content/guides/aws/caa/index.html" role="tab" aria-selected="false">üìñ GU√çA DE ESTUDIO</a>
        </div>

        <!-- ===== GU√çA DE ESTUDIO (NUBE DE CONCEPTOS) ===== -->
        <section id="studyGuide" aria-label="Conceptos a examen SAA-C03" role="tabpanel" aria-labelledby="tabGuide">
          <h2 class="sec-title" style="margin:10px 0 6px;text-transform:uppercase">Conceptos a examen ¬∑ SAA-C03</h2>
          <p class="muted" style="margin-top:0">Explora la nube de conceptos. Pasa el rat√≥n por cada burbuja para ver un tip y abre el contenido al instante. Filtra con b√∫squeda.</p>

          <div class="concept-toolbar" style="display:flex;gap:10px;align-items:center;margin:10px 0 6px">
            <input id="conceptSearch" type="search" placeholder="Buscar conceptos (ej: VPC, S3, IAM)" aria-label="Buscar conceptos"
                   style="flex:1;min-height:42px;border-radius:12px;border:1px solid var(--stroke);background:var(--surface2);color:var(--ink);padding:8px 12px;font-weight:700" />
          </div>

          <div id="conceptCloud" class="concept-cloud" role="list"></div>
        </section>
      </div>
    </section>

    <!-- ===== DOMINIOS & SIMULADOR ===== -->
    <section id="domsim" role="tabpanel" aria-labelledby="tabSim">
      <div class="wrap">
        <div class="grid-sim">
          <!-- IZQUIERDA: dominios -->
          <section class="panel" id="leftInfo">
            <div style="display:flex;gap:16px;align-items:flex-start;flex-wrap:wrap">
              <img id="provLogo" alt="AWS" style="width:66px;height:auto">
              <div id="provText" style="color:var(--muted)">Dominios oficiales y notas r√°pidas por tema.</div>
            </div>

            <h2 style="margin-top:14px">Dominios del examen</h2>
            <p class="muted" style="margin-top:-6px"><em>Haz clic en un dominio para abrir notas √∫tiles abajo.</em></p>

            <ul id="domainsList" class="domains-list"></ul>
          </section>

          <!-- DERECHA: simulador -->
          <aside class="panel" id="simCard" aria-label="Simulador SAA-C03">
            <h3 id="simTitle">SAA-C03 ¬∑ Simulador de examen</h3>

            <div class="field">
              <label>Modo</label>
              <div class="segmented" id="modeSeg">
                <input type="radio" id="modePractice" name="mode" value="practice" checked>
                <label for="modePractice">Pr√°ctica</label>
                <input type="radio" id="modeExam" name="mode" value="exam" disabled>
                <label for="modeExam" class="disabled" title="Modo examen pr√≥ximamente">Examen</label>
              </div>
            </div>

            <div class="field" style="margin-top:10px">
              <label>Preguntas</label>
              <select id="qCount" style="border:1px solid var(--stroke);border-radius:10px;padding:8px 10px;background:var(--surface2);color:var(--ink)">
                <option>5</option><option>10</option><option>15</option><option>30</option><option>65</option>
              </select>
            </div>

            <div class="field" style="margin-top:10px">
              <label>Dominios (filtro opcional)</label>
              <div id="domainChips" style="display:flex;flex-wrap:wrap;gap:8px"></div>
              <div style="color:var(--muted)">D√©jalo vac√≠o para incluir todos los dominios.</div>
            </div>

            <div class="field" style="margin-top:12px">
              <button id="startBtn" class="pill-btn" type="button">‚ñ∂ Empezar</button>
            </div>
          </aside>
        </div>

        <!-- Notas del dominio -->
        <section id="infoDom" class="panel" aria-live="polite">
          <div class="info-head">
            <h3 id="infoTitle" style="margin:0">Notas del dominio</h3>
            <button id="infoClose" class="pill-btn" type="button">‚úñ Cerrar</button>
          </div>
          <div id="infoContent" class="info-body">
            <div class="info-empty">Selecciona un dominio para ver notas ampliadas.</div>
          </div>
        </section>

        <!-- √Årea de preguntas -->
        <main id="view" class="wrap" style="padding:0"></main>
      </div>
    </section>
  </main>

  <!-- Pie -->
  <footer role="contentinfo">
    <div class="container f-grid">
      <div>
        <div class="brand" style="text-transform:none">
          <span class="logo-pill" aria-hidden="true" style="width:18px;height:34px;border-radius:10px;background:linear-gradient(180deg,#8aa0ff 0%,#425dff 100%);box-shadow:0 0 0 6px rgba(108,139,255,.18)"></span>
          <span>ITHUB.ES</span>
        </div>
        <p style="margin:8px 0 0;">Aprende, practica y aprueba tus certificaciones IT  mientras compites con el resto del mundo.<br><br>Todo lo que necesitas en un s√≥lo lugar.</p>
      </div>
      <div>
        <div style="font-weight:800">SIMULADORES</div>
        <div><a href="/certification/microsoft-azure/az-104/lz-azure-az-104.html">MICROSOFT AZURE AZ-104</a></div>
        <div><a href="/certification/microsoft-azure/az-305/lz-azure-az-305.html">MICROSOFTAZURE AZ-305</a></div>
        <div><a href="/certification/amazon aws/aws-saa-c03/lz-aws-saa-c03.html">AMAZON AWS SAA-C03</a></div>
      </div>
      <div>
        <div style="font-weight:800">DESTACADOS</div>
        <div><a href="/content/azure-identity-az104.html">Azure ¬∑ Identidad y Acceso</a></div>
        <div><a href="/content/azure-network-security-az104.html">Azure ¬∑ Seguridad en la red</a></div>
        <div><a href="/content/azure-cost-governance-az104.html">Azure ¬∑ Coste y Gobernanza</a></div>
        <div><a href="/content/azure-landing-zone.html">Azure ¬∑ Landing Zone</a></div>
        <div><a href="/content/aws-compute-elasticity-saac03.html">AWS ¬∑ Elasticidad EC2</a></div>
      </div>
      <div>
        <div style="font-weight:800">COLABORADORES</div>
        üí¨ <span><a href="https://mundoazure.cloud" target="_blank">https://mundoazure.cloud</a></span><br><br>
        <div style="font-weight:800">CONTACTO</div>
        <button id="footerContactBtn" type="button"
                style="background:none;border:none;color:#cfe1ff;
                       font-weight:800;display:inline-flex;align-items:center;
                       gap:6px;cursor:pointer;padding:0;margin-top:6px;">
          üí¨ <span>Cont√°ctanos</span>
        </button>
      </div>
    </div>
    <div class="container" style="margin-top:12px;font-size:12px;">¬© <span id="y"></span> ITHub.es</div>
  </footer>

  <!-- Modal resultados -->
  <div class="modal" id="quizResultModal" aria-hidden="true" style="display:none;">
    <div class="modal-card">
      <h3>üìä Resultados del examen</h3>
      <div id="quizScoreBox" class="panel" style="padding:12px;margin:0 0 12px;background:var(--surface2)">
        <strong id="quizScoreText">Puntuaci√≥n</strong>
      </div>
      <div id="quizDomainsGrid" class="diag-grid"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px">
        <button class="pill-btn" id="qrClose">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- Motor del simulador -->
  <script src="/control_quizs/Q_global_dark.js" defer></script>

  <script>
    // A√±o
    document.getElementById('y').textContent = new Date().getFullYear();

    /* ===== AUTH header ===== */
    function getCurrentUser(){ try{ return JSON.parse(localStorage.getItem("currentUser")||"null"); }catch{ return null; } }
    function renderHeaderAuth(){
      const u=getCurrentUser();
      const login=document.getElementById('btnLogin');
      const signup=document.getElementById('btnSignup');
      const userArea=document.getElementById('userArea');
      const nameTop=document.getElementById('userNameTop');
      if(u){ login.style.display='none'; signup.style.display='none'; userArea.style.display='flex'; nameTop.textContent=(u.name||u.email||'USER').toUpperCase(); }
      else{ login.style.display='inline-flex'; signup.style.display='inline-flex'; userArea.style.display='none'; }
    }
    document.getElementById('btnLogout')?.addEventListener('click', ()=>{ localStorage.removeItem('currentUser'); renderHeaderAuth(); updateStartCta(); });
    renderHeaderAuth();

    /* ===== Tabs (solo Sim y Guide) ===== */
    const tabSim   = document.getElementById('tabSim');
    const tabGuide = document.getElementById('tabGuide');
    const secSim   = document.getElementById('domsim');
    const secGuide = document.getElementById('studyGuide');

    function showSection(which){
      const isGuide = which === 'guide';
      const isSim   = !isGuide;

      tabGuide.classList.toggle('active', isGuide);
      tabGuide.setAttribute('aria-selected', isGuide ? 'true' : 'false');

      tabSim.classList.toggle('active', isSim);
      tabSim.setAttribute('aria-selected', isSim ? 'true' : 'false');

      secGuide.classList.toggle('open', isGuide);
      secGuide.style.display = isGuide ? 'block' : 'none';

      secSim.style.display = isSim ? 'block' : 'none';

      (isGuide ? secGuide : secSim).scrollIntoView({behavior:'smooth', block:'start'});
    }

    tabGuide.addEventListener('click', ()=>showSection('guide'));
    tabSim  .addEventListener('click', ()=>showSection('sim'));

    /* ===== Configuraci√≥n SAA-C03 ===== */
    const QUIZ = 'aws-saa-c03';
    const CONFIG = {
      'aws-saa-c03': {
        logo: 'https://upload.wikimedia.org/wikipedia/commons/9/93/Amazon_Web_Services_Logo.svg',
        blurb: 'Dominios oficiales de SAA-C03 con notas r√°pidas para el examen.',
        domains: [
          ['D1','Dise√±ar arquitecturas seguras (30%)'],
          ['D2','Dise√±ar arquitecturas resilientes (26%)'],
          ['D3','Dise√±ar arquitecturas de alto rendimiento (24%)'],
          ['D4','Dise√±ar arquitecturas optimizadas en coste (20%)']
        ]
      }
    };
    const DOMAIN_FILES = {
      'aws-saa-c03': {
        D1:'/tips/aws-saa-c03-tips-domain1.html',
        D2:'/tips/aws-saa-c03-tips-domain2.html',
        D3:'/tips/aws-saa-c03-tips-domain3.html',
        D4:'/tips/aws-saa-c03-tips-domain4.html'
      }
    };

    /* ===== Render: dominios y chips ===== */
    const badgeLogo=document.getElementById('provLogo'),
          provText=document.getElementById('provText'),
          dlist=document.getElementById('domainsList'),
          startBtn=document.getElementById('startBtn'),
          qCount=document.getElementById('qCount'),
          infoDom=document.getElementById('infoDom'),
          infoTitle=document.getElementById('infoTitle'),
          infoContent=document.getElementById('infoContent'),
          view=document.getElementById('view');

    const cfg = CONFIG[QUIZ];
    badgeLogo.src = cfg.logo; badgeLogo.alt = 'AWS';
    provText.textContent = cfg.blurb;

    dlist.innerHTML = cfg.domains.map(([d,txt]) =>
      `<li class="dom-item" data-dn="${d}">
         <span class="dom-code">${d}</span>
         <span class="dom-title">${txt}</span>
       </li>`).join('');

    // Chips filtro
    const chipsWrap = document.createElement('div');
    chipsWrap.id = 'domainChips';
    chipsWrap.style.display = 'flex';
    chipsWrap.style.flexWrap = 'wrap';
    chipsWrap.style.gap = '8px';
    document.getElementById('simCard').querySelector('.field:nth-of-type(3)').prepend(chipsWrap);

    chipsWrap.innerHTML = cfg.domains.map(([d]) =>
      `<label class="chip-dom" data-dn="${d}">
         <input type="checkbox" value="${d}" hidden>
         <span class="led"></span> ${d}
       </label>`).join('');

    function updateChipVisuals(){
      chipsWrap.querySelectorAll('.chip-dom').forEach(lbl=>{
        const cb = lbl.querySelector('input[type="checkbox"]');
        lbl.classList.toggle('on', !!cb.checked);
      });
    }
    chipsWrap.addEventListener('click', (ev)=>{
      const wrap = ev.target.closest('.chip-dom'); if(!wrap) return;
      const cb = wrap.querySelector('input[type="checkbox"]'); cb.checked = !cb.checked; updateChipVisuals();
    });
    updateChipVisuals();

    dlist.addEventListener('click', (ev)=>{
      const li = ev.target.closest('.dom-item'); if(!li) return;
      dlist.querySelectorAll('.dom-item').forEach(x=>x.classList.remove('active'));
      li.classList.add('active');
      loadDomainNotes(li.dataset.dn);
    });

    async function loadDomainNotes(domainCode){
      const map = DOMAIN_FILES[QUIZ]||{};
      const file = map[domainCode];
      infoTitle.textContent = `${domainCode} ‚Äî Notas`;
      infoDom.style.display = 'block';
      infoContent.innerHTML = `<div class="info-empty">Cargando notas‚Ä¶</div>`;
      if(!file){ infoContent.innerHTML = `<div class="info-empty">No hay archivo de notas asignado para <b>${domainCode}</b>.</div>`; return; }
      try{
        const res = await fetch(file, {cache:'no-store'});
        const html = await res.text();
        const doc = new DOMParser().parseFromString(html, 'text/html');
        doc.querySelectorAll('script,link').forEach(n=>n.remove());
        const src = doc.querySelector('.wrap') || doc.body;
        infoContent.innerHTML = src ? src.innerHTML : html;
        infoDom.scrollIntoView({behavior:'smooth', block:'start'});
      }catch(e){
        infoContent.innerHTML = `<div class="info-empty">No se pudieron cargar las notas de <b>${domainCode}</b>.</div>`;
      }
    }
    document.getElementById('infoClose').addEventListener('click', ()=>{ infoDom.style.display='none'; });

    // ===== CTA din√°mico del simulador (login/start) =====
    function updateStartCta(){
      const u = getCurrentUser();
      if(u){
        startBtn.textContent = '‚ñ∂ Empezar';
        startBtn.title = 'Inicia el simulador';
      }else{
        startBtn.textContent = 'üîê Login para empezar';
        startBtn.title = 'Debes iniciar sesi√≥n para usar el simulador';
      }
    }
    updateStartCta();

    // Simulador
    let quizActive = false;
    const header = document.querySelector('header');
    function smoothScrollTo(el){
      if(!el) return;
      const rect = el.getBoundingClientRect();
      const offset = (header?header.offsetHeight:0)+10;
      const top = rect.top + window.scrollY - offset;
      window.scrollTo({ top, behavior:'smooth' });
    }
    function setQuizActive(on){
      quizActive = !!on;
      startBtn.disabled = quizActive;
      startBtn.textContent = quizActive ? '‚è≥ En marcha‚Ä¶' : (getCurrentUser() ? '‚ñ∂ Empezar' : 'üîê Login para empezar');
      startBtn.setAttribute('aria-disabled', quizActive ? 'true' : 'false');
    }
    function waitForQuizMount(timeout=4000){
      return new Promise(resolve=>{
        if (view.children.length>0) return resolve();
        const obs = new MutationObserver(()=>{ if(view.children.length>0){ obs.disconnect(); resolve(); }});
        obs.observe(view,{childList:true});
        setTimeout(()=>{ obs.disconnect(); resolve(); }, timeout);
      });
    }
    window.addEventListener('quiz:started', ()=>{ setQuizActive(true); smoothScrollTo(document.querySelector('#view .question-card')||view); });
    window.addEventListener('quiz:ended',   ()=>{ setQuizActive(false); });

    startBtn.addEventListener('click', async ()=>{
      if (quizActive) return;
      if(!getCurrentUser()){
        window.location.href = '/login/login.html';
        return;
      }
      if (infoDom.style.display !== 'none') { infoDom.style.display='none'; }
      const count = parseInt(qCount.value,10) || 65;
      const tags = []; // incluir todos los dominios
      if(typeof window.start === 'function'){
        setQuizActive(true);
        window.start(QUIZ, { count, tags });
        await waitForQuizMount();
        smoothScrollTo(document.querySelector('#view .question-card')||view);
      }else{
        setQuizActive(false);
        alert('Motor de simulador no cargado.');
      }
    });

    /* ===== Resultados modal ===== */
    const qrModal = document.getElementById('quizResultModal');
    const qrClose = document.getElementById('qrClose');
    const qrGrid  = document.getElementById('quizDomainsGrid');
    const qrScore = document.getElementById('quizScoreText');
    function percent(a,b){ return b ? Math.round((a/b)*100) : 0; }
    function barClass(p){ return p<50?'m-bad':(p<75?'m-warn':'m-ok'); }
    function showResultsModal(data){
      const s = Number(data?.score||0), t = Number(data?.total||0);
      qrScore.textContent = `Puntuaci√≥n: ${s}/${t} (${percent(s,t)}%)`;
      qrGrid.innerHTML = '';
      const byDom = data?.byDomain || null;
      if(byDom && Object.keys(byDom).length){
        Object.entries(byDom).forEach(([code,info])=>{
          const p = percent(info.correct, info.total);
          const card = document.createElement('div');
          card.className = 'panel';
          card.style.padding='12px';
          card.style.background='var(--surface2)';
          card.innerHTML = `
            <div style="font-weight:900;margin-bottom:6px">${info.name||code}</div>
            <div class="meter"><span class="${barClass(p)}" style="width:${p}%"></span></div>
            <div style="color:var(--muted);margin-top:6px">${info.correct}/${info.total} aciertos ¬∑ ${p}%</div>
          `;
          qrGrid.appendChild(card);
        });
      }
      qrModal.classList.add('show');
      qrModal.style.display = 'flex';
    }
    qrClose.addEventListener('click', ()=>{ qrModal.classList.remove('show'); qrModal.style.display='none'; });
    qrModal.addEventListener('click', (e)=>{ if(e.target===qrModal){ qrModal.classList.remove('show'); qrModal.style.display='none'; } });
    window.quizResults = showResultsModal;
    window.addEventListener('quiz:results', (e)=> showResultsModal(e.detail||{}));

    /* ===== Nube de conceptos ===== */
    const CONCEPTS = [
      { key:'iam',  title:'IAM & Roles',           tip:'Usa roles + STS para accesos temporales y evita claves largas.', href:'/content/aws-iam-organizations-saac03.html' },
      { key:'s3',   title:'S3: clases',            tip:'IA para acceso poco frecuente, Glacier para archivado.', href:'/content/aws-s3-design-saac03.html' },
      { key:'ddb',  title:'DynamoDB',              tip:'Cuida particiones: claves hot ‚Üí on-demand + cach√©.', href:'/content/aws-databases-storage-saac03.html' },
      { key:'endp', title:'VPC Endpoints',         tip:'Gateway para S3/DynamoDB; Interface para el resto.', href:'/content/aws-vpc-advanced-endpoints-saac03.html' },
      { key:'asg',  title:'Auto Scaling',          tip:'Escala por m√©tricas/pasos y combina con Spot.', href:'/content/aws-compute-elasticity-saac03.html' },
      { key:'obs',  title:'Observabilidad',        tip:'CloudWatch + Logs + Alarms; auditor√≠a con CloudTrail.', href:'/content/aws-observability-saac03.html' }
    ];
    function renderConceptCloud(){
      const cloud = document.getElementById('conceptCloud');
      cloud.innerHTML = CONCEPTS.map(c=>`
        <a role="listitem" class="chip-bubble" data-key="${c.key}" data-title="${c.title.toLowerCase()}" data-tip="${c.tip.toLowerCase()}" href="${c.href}">
          <span class="cb-title">${c.title}</span>
          <span class="cb-tip">${c.tip} <b>Leer ‚Üí</b></span>
        </a>
      `).join('');
    }
    function hookConceptSearch(){
      const input = document.getElementById('conceptSearch');
      const cloud = document.getElementById('conceptCloud');
      input.addEventListener('input', ()=>{
        const q = input.value.trim().toLowerCase();
        cloud.querySelectorAll('.chip-bubble').forEach(b=>{
          const hay = (b.dataset.title + ' ' + b.dataset.tip + ' ' + b.dataset.key);
          b.style.display = hay.includes(q) ? 'flex' : 'none';
        });
      });
    }

    // Render inicial
    renderConceptCloud();
    hookConceptSearch();
  </script>
</body>
</html>
